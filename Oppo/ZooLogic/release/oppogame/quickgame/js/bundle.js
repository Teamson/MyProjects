!function(){"use strict";class t{constructor(){this.grade=1,this.bodyArr=[1,0,0,0,0,0],this.headArr=[1,1,1,1,1,0,0,0,0,0],this.legArr=[1,1,1,1,1,0,0,0,0,0],this.tailArr=[1,1,0,0],this.wingsArr=[0,0]}}class e{constructor(){this.head=[[2,1,25],[4,2,30],[6,3,35],[8,4,40],[10,5,45],[12,6,50],[14,7,55],[16,8,60],[18,9,65],[20,10,70]],this.leg=[[2,1,25],[4,2,30],[6,3,35],[8,4,40],[10,5,45],[12,6,50],[14,7,55],[16,8,60],[18,9,65],[20,10,70]],this.tail=[[5,2,20],[10,4,30],[15,6,40],[20,8,50]],this.wings=[[10,5,50],[10,5,50]]}}class a{static getPlayerData(){return localStorage.getItem("playerData")?null==this._playerData&&(this._playerData=JSON.parse(localStorage.getItem("playerData"))):(this._playerData=new t,localStorage.setItem("playerData",JSON.stringify(this._playerData))),this._playerData}static setPlayerData(){localStorage.setItem("playerData",JSON.stringify(this._playerData))}static getBodyName(t){return["美洲狮 身体","大象 身体","青蛙 身体","长颈鹿 身体","马 身体","霸王龙 身体"][t]}static getHeadName(t){return["美洲狮 头","鹿 头","鸭子 头","大象 头","青蛙 头","长颈鹿 头","马 头","人类 头","独角兽 头","霸王龙 头"][t]}static getLegName(t){return["美洲狮 腿","大象 腿","青蛙 腿","青蛙 腿","长颈鹿 腿","马 腿","人类 手","人类 腿","霸王龙 腿","霸王龙 腿"][t]}static getTailName(t){return["美洲狮 尾巴","大象 尾巴","长颈鹿 尾巴","马 尾巴"][t]}static getWingsName(t){return["蝙蝠 翅膀","独角兽 翅膀"][t]}static getDataByType(t){let e=[];return 0==t?e=this._playerData.headArr:1==t?e=this._playerData.legArr:2==t?e=this._playerData.tailArr:3==t&&(e=this._playerData.wingsArr),e}static getItemData(){return this._itemData||(this._itemData=new e),this._itemData}static getInvalidSkins(){let t=[];for(let e=0;e<4;e++){let a=this.getDataByType(e);for(let i=0;i<a.length;i++)0==a[i]&&t.push([e,i])}return t}static unlockBody(){for(let t=0;t<this._playerData.bodyArr.length;t++)if(0==this._playerData.bodyArr[t])return this._playerData.bodyArr[t]=1,void this.setPlayerData()}}a._playerData=null,a._itemData=null;class i{static LoginWx(t){if(!Laya.Browser.onQGMiniGame)return;let e=Laya.Browser.window.qg.getLaunchOptionsSync();Laya.Browser.window.qg.login({success(a){a.code&&(console.log("res.code:",a.code),t&&t(a.code,e.query))}})}static GetLaunchParam(t){Laya.Browser.onQGMiniGame&&(this.OnShowFun=t,t(this.GetLaunchPassVar()),Laya.Browser.window.qg.onShow(t=>{null!=this.OnShowFun&&this.OnShowFun(t),console.log("wx on show")}))}static GetLaunchPassVar(){return Laya.Browser.onQGMiniGame?Laya.Browser.window.qg.getLaunchOptionsSync():null}static WxOnHide(t){Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.onHide(t)}static WxOffHide(t){t&&Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.offHide(t)}static WxOnShow(t){Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.onShow(t)}static WxOffShow(t){t&&Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.offShow(t)}static httpRequest(t,e,a="get",i){var s=new Laya.HttpRequest;s.http.timeout=5e3,s.once(Laya.Event.COMPLETE,this,i),s.once(Laya.Event.ERROR,this,this.httpRequest,[t,e,a,i]),"get"==a?s.send(t+"?"+e,"",a,"text"):"post"==a&&s.send(t,JSON.stringify(e),a,"text")}static DoVibrate(t=!0){Laya.Browser.onQGMiniGame&&this.isVibrate&&(t?Laya.Browser.window.qg.vibrateShort():Laya.Browser.window.qg.vibrateLong())}static OpenAlert(t,e=2e3,a=!1){Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.showToast({title:t,duration:e,mask:!1,icon:a?"success":"none"})}static preViewImage(t){Laya.Browser.onQGMiniGame&&Laya.Browser.window.qg.previewImage({current:t,urls:[t]})}}i.UnityPath="LayaScene_SampleScene/Conventional/",i.version="",i.isVibrate=!0,i.isMusic=!0,i.OnShowFun=null;class s{constructor(){this.effectArr=[]}static get instance(){return this._instance||(this._instance=new s),this._instance}initLoading(t){var e=[{url:"res/Sounds/Click.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/Get.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/Hurt.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/Win.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/Lose.mp3",type:Laya.Loader.SOUND}];Laya.loader.load(e,Laya.Handler.create(this,t)),Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1)}playMusic(t,e=0,a){Laya.SoundManager.playMusic("res/Sounds/"+t,e,new Laya.Handler(this,a))}stopMusic(){Laya.SoundManager.stopMusic()}playSoundEffect(t,e=1,a,i,s){return Laya.SoundManager.playSound("res/Sounds/"+t,e,new Laya.Handler(this,a),i,s)}stopSound(t){Laya.SoundManager.stopSound("res/Sounds/"+t)}}class o{static calcDistance(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}static getWorldDis(t,e){let a=t.transform.position.clone(),i=e.transform.position.clone();return Laya.Vector3.distance(a,i)}static getDirectionAToB(t,e,a=!0){let i=t.transform.position.clone(),s=e.transform.position.clone(),o=new Laya.Vector3(0,0,0);return Laya.Vector3.subtract(s,i,o),a&&Laya.Vector3.normalize(o,o),o}static fixPosY(t,e=1334){return t*Laya.stage.displayHeight/e}static findNodeByName(t,e){let a=null,i=t=>{for(let s=0;s<t.numChildren;s++){if(t.getChildAt(s).name==e)return void(a=t.getChildAt(s));i(t.getChildAt(s))}};return i(t),a}static TmoveTo(t,e,a,i,s){if(!t.transform)return;let o=new Laya.Tween;var n=t.transform.position;o.to(t.transform.position,{x:a.x,y:a.y,z:a.z,update:new Laya.Handler(this,()=>{t.transform&&(t.transform.position=n)})},e,s,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToYZ(t,e,a,i,s){if(!t.transform)return;let o=new Laya.Tween;var n=t.transform.position;return o.to(t.transform.position,{y:a.y,z:a.z,update:new Laya.Handler(this,()=>{t.transform&&(t.transform.position=n)})},e,null,Laya.Handler.create(this,()=>{i&&i()})),o}static TmoveToX(t,e,a,i,s){if(!t.transform)return;let o=new Laya.Tween;var n=t.transform.localPosition;o.to(t.transform.localPosition,{x:a.x,update:new Laya.Handler(this,()=>{t.transform&&(t.transform.localPosition=n)})},e,null,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToY(t,e,a,i,s){if(!t.transform)return;let o=new Laya.Tween;var n=t.transform.localPosition;o.to(t.transform.localPosition,{y:a.y,update:new Laya.Handler(this,()=>{t.transform&&(t.transform.localPosition=n)})},e,s,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToWorld(t,e,a,i,s){if(!t.transform)return;let o=new Laya.Tween;var n=t.transform.position;o.to(t.transform.position,{y:a.y,update:new Laya.Handler(this,()=>{t.transform&&(t.transform.position=n)})},e,null,Laya.Handler.create(this,()=>{i&&i()}))}static RotateWithPoint(t,e,a){let i=new Laya.Vector3,s=t.transform.localPosition.clone();return a=a*Math.PI/180,i.x=s.x*Math.cos(a)+(e.y*s.z-e.z*s.y)*Math.sin(a)+e.x*(e.x*s.x+e.y*s.y+e.z*s.z)*(1-Math.cos(a)),i.y=s.y*Math.cos(a)+(e.x*s.z-e.z*s.x)*Math.sin(a)+e.y*(e.x*s.x+e.y*s.y+e.z*s.z)*(1-Math.cos(a)),i.z=s.z*Math.cos(a)+(e.x*s.y-e.y*s.x)*Math.sin(a)+e.z*(e.x*s.x+e.y*s.y+e.z*s.z)*(1-Math.cos(a)),i}static RotateTo(t,e,a,i){var s=t.transform.rotationEuler;Laya.Tween.to(t.transform.rotationEuler,{x:a.x,y:a.y,z:a.z,update:new Laya.Handler(this,function(){t&&(t.transform.rotationEuler=s)})},e,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){i&&i()}))}static tMove2D(t,e,a,i,s){Laya.Tween.to(t,{x:e,y:a},i,null,new Laya.Handler(this,()=>{s&&s()}))}static scaleTo2D(t,e,a,i){Laya.Tween.to(t,{scaleX:e,scaleY:e},a,null,new Laya.Handler(this,()=>{i&&i()}))}static alphaTo2D(t,e,a,i){Laya.Tween.to(t,{alpha:e},a,null,new Laya.Handler(this,()=>{i&&i()}))}static updateNumber(t,e,a,i=!0,s,o){let n=t*e,r=Math.floor((n-t)/60);r=r<=0?1:r;let h=()=>{s?((t+=r)>=n&&(t=n,o&&o(),Laya.timer.clear(this,h)),i?a.text=t.toString():a.value=t.toString()):((n-=r)<=t&&(n=t,o&&o(),Laya.timer.clear(this,h)),i?a.text=n.toString():a.value=n.toString())};Laya.timer.frameLoop(1,this,h)}static loadJson(t,e){Laya.loader.load(t,Laya.Handler.create(this,e),null,Laya.Loader.JSON)}static objectShake(t,e=1,a=.7){var i=e,s=1,o=t.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(i>0){var e=new Laya.Vector3;Laya.Vector3.scale((n=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(n,r,0)),a,e),Laya.Vector3.add(o,e,e),t.transform.localPosition=e,i-=.02*s}else i=0,t.transform.localPosition=o,Laya.timer.clear(this,updateShake);var n,r})}static getRandomItemInArr(t){return t[Math.floor(Math.random()*t.length)]}static shuffleArr(t){let e=t.length;for(;e;){let a=Math.floor(Math.random()*e--);[t[a],t[e]]=[t[e],t[a]]}return t}static GetRandom(t,e,a=!0){let i=e-t,s=Math.random()*(i+1);return s+=t,a?Math.floor(s):s}static coinCollectAnim(t,e,a,i=10,s){let o=i;for(var n=0;n<i;n++){let i=Laya.Pool.getItemByClass("coin",Laya.Image);i.skin="startUI/zy_zs_1.png",i.x=t.x,i.y=t.y,a.addChild(i);let n=300+100*Math.random()-50;Laya.Tween.to(i,{x:i.x+250*Math.random()-125,y:i.y+250*Math.random()-125},n),Laya.timer.once(n+50,this,function(){Laya.Tween.to(i,{x:e.x,y:e.y},400,null,new Laya.Handler(this,function(){a.removeChild(i),Laya.Pool.recover("coin",i),0==--o&&s&&s()}))})}}static scaleLoop(t,e,a){Laya.Tween.to(t,{scaleX:e,scaleY:e},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(t,{scaleX:1,scaleY:1},a,null,new Laya.Handler(this,()=>{this.scaleLoop(t,e,a)}))}))}static rotateLoop(t,e,a){Laya.Tween.to(t,{rotation:e},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(t,{rotation:-e},2*a,null,new Laya.Handler(this,()=>{Laya.Tween.to(t,{rotation:0},a,null,new Laya.Handler(this,()=>{this.rotateLoop(t,e,a)}))}))}))}static visibleDelay(t,e){t.visible=!1,Laya.timer.once(e,this,()=>{t.visible=!0})}static pointInPolygon(t,e){for(var a=t.x,i=t.y,s=!1,o=0,n=e.length-1;o<e.length;n=o++){var r=e[o].x,h=e[o].y,l=e[n].x,d=e[n].y;h>i!=d>i&&a<(l-r)*(i-h)/(d-h)+r&&(s=!s)}return s}static getSprite3DResByUrl(t,e,a=!1){let s=Laya.loader.getRes(i.UnityPath+t);return Laya.Sprite3D.instantiate(s,e,a,new Laya.Vector3(0,0,0))}static getRandomItemInArrWithoutSelf(t,e,a=1){let i=[].concat(e);return i.splice(i.indexOf(t),1),(i=this.shuffleArr(i)).slice(0,a)}static getBoundBox(t,e=!1){let a=t.getComponent(Laya.PhysicsCollider).colliderShape,i=t.transform.position.clone();i.x+=a.localOffset.x,i.y+=a.localOffset.y,i.z+=a.localOffset.z;let s=t.parent,o=1;s&&s.transform&&e&&(o=s.transform.localScaleZ);let n=new Laya.Vector3(i.x-a.sizeX/2,i.y-a.sizeY/2,i.z-a.sizeZ/2),r=new Laya.Vector3(i.x+a.sizeX/2,i.y+a.sizeY/2,i.z+a.sizeZ*o/2/2);return new Laya.BoundBox(n,r)}static getBoundBoxWithMinMax(t,e){return new Laya.BoundBox(t,e)}static addClickEvent(t,e,a,i,o){if(t.offAllCaller(e),t instanceof Laya.Button&&!o){let s=t=>{a&&a.call(e,t)};t.on(Laya.Event.CLICK,e,s,[i])}else{let o=60,n=1,r=t.scaleX*n,h=t.scaleY*n,l=.9*n,d=!1,c=e=>{d=!0,s.instance.playSoundEffect("Click.mp3"),Laya.Tween.to(t,{scaleX:l,scaleY:l},o)};t.on(Laya.Event.MOUSE_DOWN,e,c,[i]);let y=i=>{0!=d&&(d=!1,Laya.Tween.to(t,{scaleX:r,scaleY:h},o,null,new Laya.Handler(e,()=>{a&&a.call(e,i)})))};t.on(Laya.Event.MOUSE_UP,e,y,[i]);let m=e=>{Laya.Tween.to(t,{scaleX:r,scaleY:h},o)};t.on(Laya.Event.MOUSE_OUT,e,m,[i])}}static getVector3(t,e,a){return new Laya.Vector3(Number(t),Number(e),Number(a))}}class n extends Laya.Script{constructor(){super()}onAwake(){this.myOwner=this.owner}onDisable(){}onUpdate(){if(!u.Share.isGameOver&&u.Share._player&&!u.Share._player.destroyed)if(u.Share.isMeet){let t=this.myOwner.transform.position.clone();t.x=(u.Share._player.transform.position.x+u.Share._enemy.transform.position.x)/2,Laya.Vector3.lerp(this.myOwner.transform.position.clone(),t,.1,t),this.myOwner.transform.position=t;let e=Math.abs(u.Share._player.transform.position.x-u.Share._enemy.transform.position.x);e>10&&(e=10),this.myOwner.fieldOfView=60+e/10*10}else{let t=this.myOwner.transform.position.clone();t.x=u.Share._player.transform.position.clone().x,Laya.Vector3.lerp(this.myOwner.transform.position.clone(),t,.1,t),this.myOwner.transform.position=t}}}var r,h,l;function __awaiter(t,e,a,i){return new(a||(a=Promise))(function(s,o){function fulfilled(t){try{step(i.next(t))}catch(t){o(t)}}function rejected(t){try{step(i.throw(t))}catch(t){o(t)}}function step(t){t.done?s(t.value):new a(function(e){e(t.value)}).then(fulfilled,rejected)}step((i=i.apply(t,e||[])).next())})}class d{constructor(){this._count=0,this._lowestCount=0,this._items={}}enqueue(t){this._items[this._count]=t,this._count++}dequeue(){if(this.isEmpty())return;const t=this._items[this._lowestCount];return delete this._items[this._lowestCount],this._lowestCount++,t}peek(){if(!this.isEmpty())return this._items[this._lowestCount]}isEmpty(){return 0===this.size()}size(){return this._count-this._lowestCount}toString(){if(this.isEmpty())return"";let t=`${this._items[this._lowestCount]}`;for(let e=this._lowestCount+1;e<this._count;e++)t=`${t},${this._items[e]}`;return t}}class c{constructor(){this.loadNextDelay=5e3,this._entities=null,this._displayEntities=[],this._posIds=[],this._usedPosIds=[],this._errorPosIds=[],this._posIdCount=0,this._entities=new d,this._posIds=m.jsonConfig.array_nativeId,this._posIdCount=this._posIds.length,this.loadAd(this._posIds),Laya.timer.loop(1e4,this,()=>{this.checkError()})}getFreePosIds(){let t=[];for(let e=0;e<this._posIdCount;e++){const a=this._posIds[e];-1==this._usedPosIds.indexOf(a)&&-1==this._errorPosIds.indexOf(a)&&t.push(a)}return 0==t.length&&(t=this._errorPosIds.concat()),this._errorPosIds=[],t=t.sort((t,e)=>Math.random()<.5?1:-1)}createAd(t,e){if(!t)return void(e&&e(null));this._usedPosIds.push(t);const a=this.createNativeAd(t);a.onLoad(i=>{const s={ad:a,posId:t,adInfo:i.adList[0],isClick:!1,displayDuration:0,displayTime:0};this.log("loaded:",t,", ad:",s.adInfo),e&&e(s)}),a.onError(i=>{this._usedPosIds.splice(this._usedPosIds.indexOf(t),1),this._errorPosIds.push(t),this.log("error:",t,", msg:",i.msg),e&&e(null),a.destroy()}),a.load(),this.log("create:",t)}destoryAd(t){t&&t.ad&&(this._usedPosIds.splice(this._usedPosIds.indexOf(t.posId),1),this.log(`destroy -- posId:${t.posId}, adId:${t.adInfo.adId}`),t.ad.destroy&&t.ad.destroy(),t=null)}loadAd(t){t&&t.length>0&&(this.log("load ad:",t.toString()),t.forEach(t=>{this.createAd(t,t=>{t&&this._entities.enqueue(t)})}))}showAd(){return __awaiter(this,void 0,void 0,function*(){const t=this._displayEntities.shift()||this._entities.dequeue()||(yield(()=>(this.log("create for show"),new Promise(t=>{const e=this.getFreePosIds();e&&e.length>0?this.createAd(e[0],e=>{t(e)}):t(null)})))());if(t&&(t.displayTime=Date.now(),0==t.displayDuration)){const e=t.adInfo.adId;t.ad.reportAdShow({adId:e})}return this._displayEntities.push(t),this.checkAdEnough()||this.loadAd(this.getFreePosIds()),t})}clickAd(t){const e=this.getDisplayEntity(t);if(e){e.isClick=!0;const t=e.adInfo.adId;e.ad.reportAdClick({adId:t}),this.log("clicked:",t)}}hideAd(t){const e=this.getDisplayEntity(t);e&&(e.displayDuration+=(Date.now()-e.displayTime)/1e3,(e.isClick||e.displayDuration>=m.jsonConfig.account_refBotNativeAd)&&(this.destoryAd(e),this._displayEntities.splice(this._displayEntities.indexOf(e),1),this.checkAdEnough()||this.loadAd(this.getFreePosIds())))}getDisplayEntity(t){let e;for(let a=this._displayEntities.length-1;a>=0;a--)if(this._displayEntities[a].adInfo.adId===t){e=this._displayEntities[a];break}return e}lateTrigger(){return __awaiter(this,void 0,void 0,function*(){let t=!1;const e=this._displayEntities.length;if(e>0)for(let a=e-1;a>=0;a--){const e=this._displayEntities[a];if(e&&!e.isClick){const a=e.adInfo.adId;e.ad.reportAdClick({adId:a}),t=!0,console.log("trigger displaying native ad");break}}if(!t){const t=yield this.showAd();if(t)return this.clickAd(t.adInfo.adId),Laya.timer.frameOnce(1,this,()=>{this.hideAd(t.adInfo.adId)}),void console.log("trigger new native ad");console.log("fail to trigger native ad")}})}checkAdEnough(){return this._entities.size()>=Math.ceil(this._posIdCount/2)}log(...t){console.log("[native-ad] -- ",...t)}checkError(){if(this._errorPosIds.length>=Math.max(1,this._posIdCount-2)){const t=this._errorPosIds.concat();this._errorPosIds=[],this.loadAd(t)}}get isAllError(){return this._errorPosIds.length>=this._posIdCount}createNativeAd(t){return t?window.qg.createNativeAd&&window.qg.createNativeAd({adUnitId:t}):null}}class y{static get oppoPlatform(){return Laya.Browser.onQGMiniGame}static initAllAd(){this.oppoPlatform&&(this.shareNativeAd=new c,this.createVideo(),this.createBanner(),this.createGamePortalAd())}static createBanner(){if(this.oppoPlatform&&m.jsonConfig.is_bannerAd){this.bannerIdArr=m.jsonConfig.array_bannerId,this.bannerErrorArr=[];for(let t=0;t<this.bannerIdArr.length;t++)this.bannerErrorArr.push(!0);for(let t=0;t<this.bannerIdArr.length;t++){let e=this.getBannerAd(t);this.bannerAdArr.push(e)}}}static getBannerAd(t){let e=window.qg.createBannerAd({adUnitId:this.bannerIdArr[t]});return e.onLoad(()=>{console.log("banner加载成功：",t),this.bannerErrorArr[t]=!1}),e.onError(e=>{console.log("banner加载失败：",e),this.bannerErrorArr[t]=!0}),e.show(),e.hide(),e}static showBanner(){this.oppoPlatform&&this.bannerAdArr[this.bannerIndex]&&m.isOneMinutedAd&&(this.hideBanner(),this.bannerAdArr[this.bannerIndex].show(),this.bannerIndex++,this.bannerIndex>=this.bannerAdArr.length&&(this.bannerIndex=0))}static hideBanner(){if(this.oppoPlatform)for(let t=0;t<this.bannerAdArr.length;t++)this.bannerErrorArr[t]||this.bannerAdArr[t].hide()}static createVideo(){this.rewardedAd=Laya.Browser.window.qg.createRewardedVideoAd({posId:m.jsonConfig.array_videoId[0]}),this.rewardedAd.load(),this.videoLoading=!0,this.rewardedAd.onError(t=>{this.videoLoaded=!1,this.videoLoading=!1,this.videoCompleteCB&&this.videoCompleteCB(),this.videoCompleteCB=null,console.log("激励视频广告加载失败",JSON.stringify(t))}),this.rewardedAd.onLoad(()=>{console.log("加载视频成功"),this.videoLoaded=!0,this.videoLoading=!1});this.rewardedAd.onClose(t=>{t&&t.isEnded&&this.videoCCB&&this.videoCCB(),this.videoCompleteCB&&this.videoCompleteCB(),this.videoCCB=null,this.videoLoaded=!1,this.videoLoading=!0,this.rewardedAd.load()})}static loadVideo(){this.videoLoaded=!1,this.videoLoading=!0,this.rewardedAd.load()}static showVideo(t,e){if(!this.oppoPlatform||!m.isOneMinutedAd)return t&&t(),void(e&&e());this.videoCCB=t,this.videoCompleteCB=e,this.videoLoading?(console.log("激励视频广告正在加载中！"),this.videoCompleteCB&&this.videoCompleteCB()):this.videoLoaded?this.rewardedAd.show().then().catch(()=>{this.videoCompleteCB&&this.videoCompleteCB()}):(this.videoCompleteCB&&this.videoCompleteCB(),this.videoCCB&&this.videoCCB(),this.loadVideo())}static createGamePortalAd(){this.oppoPlatform&&(this.gamePortalAd=Laya.Browser.window.qg.createGamePortalAd({adUnitId:m.jsonConfig.array_gamePortalID[0]}),this.gamePortalAd.load(),this.gamePortalAd.onError(()=>{this.gamePortalAdError=!0,this.gamePortalCCB&&this.gamePortalCCB(),console.log("互推盒子九宫格广告创建失败")}),this.gamePortalAd.onLoad(()=>{this.gamePortalAdError=!1,console.log("互推盒子九宫格广告创建成功")}),this.gamePortalAd.onClose(()=>{this.gamePortalCCB&&this.gamePortalCCB()}))}static showGamePortalAd(t){this.oppoPlatform&&this.gamePortalAd&&!this.getGameportalAdError()&&m.isOneMinutedAd?(this.gamePortalCCB=t,this.gamePortalAd.show()):t&&t()}static getGameportalAdError(){return this.gamePortalAdError}static shuffleArr(t){let e=t.length;for(;e;){let a=Math.floor(Math.random()*e--);[t[a],t[e]]=[t[e],t[a]]}return t}static getRandomItemInArrWithoutSelf(t,e,a=1){let i=[].concat(e);return i.splice(i.indexOf(t),1),(i=this.shuffleArr(i)).slice(0,a)}static getRandomItemInArr(t){return t[Math.floor(Math.random()*t.length)]}}y.shareNativeAd=null,y.bannerIdArr=[],y.bannerAdArr=[],y.bannerIndex=0,y.bannerErrorArr=[],y.rewardedAd=null,y.videoLoading=!1,y.videoLoaded=!1,y.videoCCB=null,y.videoCompleteCB=null,y.gamePortalAd=null,y.gamePortalAdError=!1,y.gamePortalCCB=null;class m{static randTouchProgress(){this.wuchuProgressValue<.19?this.wuchuProgressValue=this.getRangeNumer(.08,.3):this.wuchuProgressValue=this.getRangeNumer(this.wuchuProgressValue-.19+.08,this.wuchuProgressValue-.19+.3)}static getRangeNumer(t,e){return Math.random()*(e-t)+t}static timeCounter(){this.gameTime+=.1}static get isOneMinutedAd(){return!!this.jsonConfig.is_oneMinuteAd||this.gameTime>=60}static get isAccountLateTime(){return this.gameTime>=this.jsonConfig.account_lateTime}static setNativeMissTouched(){this.nativeMissTouched=!0,Laya.timer.clear(this,this.resetNativeMissTouched),Laya.timer.once(1e3*this.jsonConfig.account_lateNextTime,this,this.resetNativeMissTouched)}static resetNativeMissTouched(){this.nativeMissTouched=!1}static init(t){Laya.timer.loop(100,this,this.timeCounter),this.randTouchProgress(),Laya.Browser.onQGMiniGame?this.getConfig(t):t&&t()}static beforeHome(t){this.gameProcessUI0(t)}static inHome(){this.showFDHomeUI(),0==this.jsonConfig.is_homeUIShowAd?y.shareNativeAd.isAllError&&this.jsonConfig.is_homeNativeErrorShowBanner?y.showBanner():this.showBannerNativeUI():1==this.jsonConfig.is_homeUIShowAd&&y.showBanner()}static clickStart(t){let e=()=>{this.jsonConfig.is_startBtnLate?(y.shareNativeAd.lateTrigger(),Laya.timer.once(500,this,()=>{this.gameProcessUI1(t)})):this.gameProcessUI1(t),this.hadClickStart=!1,this.hadShowHomeGiftBox=!1};this.hadShowHomeGiftBox||this.hadClickStart?this.hadShowHomeGiftBox&&(y.hideBanner(),this.closeBannerNativeUI(),this.closeFDHomeUI(),e()):(this.hadClickStart=!0,0==this.jsonConfig.Button_clickpop?(y.hideBanner(),this.closeBannerNativeUI(),this.closeFDHomeUI(),e()):1==this.jsonConfig.Button_clickpop?Laya.timer.once(1e3*this.jsonConfig.Button_isinvalid,this,()=>{y.hideBanner(),this.closeBannerNativeUI(),this.closeFDHomeUI(),this.showGiftBoxUI(0,0,0,()=>{this.hadShowHomeGiftBox=!0,this.inHome()})}):2==this.jsonConfig.Button_clickpop&&Laya.timer.once(1e3*this.jsonConfig.Button_isinvalid,this,()=>{y.hideBanner(),this.closeBannerNativeUI(),this.closeFDHomeUI(),this.showGiftBoxUI(Math.random()<.5?1:2,0,0,()=>{this.hadShowHomeGiftBox=!0,this.inHome()})}))}static inGame(t,e){this.showGameAd(),this.gameGiftBoxOCB=t,this.gameGiftBoxCCB=e,this.gameGiftTimeArr=[].concat(this.jsonConfig.Second_the_up);for(let t=this.gameGiftTimeArr.length-1;t>=0;t--)t<=0||(this.gameGiftTimeArr[t]=this.gameGiftTimeArr[t]-this.gameGiftTimeArr[t-1]);!this.gameGiftTimeArr||this.gameGiftTimeArr.length<=0||Laya.timer.once(1e3*this.gameGiftTimeArr.shift(),this,this.showGameGiftBoxUI)}static showGameAd(){0!=this.jsonConfig.level_nativeType&&2!=this.jsonConfig.level_nativeType||(y.shareNativeAd.isAllError&&this.jsonConfig.is_gameNativeErrorShowBanner?y.showBanner():this.showBannerNativeUI()),0!=this.jsonConfig.level_nativeType&&1!=this.jsonConfig.level_nativeType||this.showGridNativeUI()}static showGameGiftBoxUI(){y.hideBanner(),this.closeBannerNativeUI(),this.closeGridNativeUI(),this.gameGiftBoxOCB&&this.gameGiftBoxOCB(),this.showGiftBoxUI(Math.random()<.5?1:2,1,this.jsonConfig.Second_the_up.length-1-this.gameGiftTimeArr.length,()=>{this.gameGiftBoxCCB&&this.gameGiftBoxCCB(),this.showGameAd(),!this.gameGiftTimeArr||this.gameGiftTimeArr.length<=0||Laya.timer.once(1e3*this.gameGiftTimeArr.shift(),this,this.showGameGiftBoxUI)})}static gameOver(t){Laya.timer.clear(this,this.showGameGiftBoxUI),y.hideBanner(),this.closeBannerNativeUI(),this.closeGridNativeUI(),this.gameProcessUI2(t)}static inFinish(){y.showBanner(),this.showMiddleNativeUI(null,!0)}static backToHome(t){let e=()=>{this.jsonConfig.is_nextBtnLate&&y.shareNativeAd.lateTrigger(),this.gameProcessUI3(()=>{this.gameProcessUI0(t)}),this.hadClickBackBtn=!1,this.hadShowBackGiftBox=!1};this.hadShowBackGiftBox||this.hadClickBackBtn?this.hadShowBackGiftBox&&(this.closeMiddleNativeUI(),y.hideBanner(),e()):(this.hadClickBackBtn=!0,0==this.jsonConfig.Super_giftbag?(this.closeMiddleNativeUI(),y.hideBanner(),e()):1==this.jsonConfig.Super_giftbag&&Laya.timer.once(1e3*this.jsonConfig.Button_isinvalid2,this,()=>{this.closeMiddleNativeUI(),y.hideBanner(),this.showGiftBoxUI(0,2,0,()=>{this.hadShowBackGiftBox=!0,this.inFinish()})}))}static gameProcessUI0(t){let e=[].concat(this.jsonConfig.gameProcess_setting),a=[];for(let t=0;t<e.length&&1!=e[t];t++)a.push(e[t]);this.repeatShowUIByType(a,t)}static gameProcessUI1(t){let e=[].concat(this.jsonConfig.gameProcess_setting);e.splice(0,e.indexOf(1)+1);let a=[];for(let t=0;t<e.length&&2!=e[t];t++)a.push(e[t]);this.repeatShowUIByType(a,t)}static gameProcessUI2(t){let e=[].concat(this.jsonConfig.gameProcess_setting);e.splice(0,e.indexOf(2)+1);let a=[];for(let t=0;t<e.length&&3!=e[t];t++)a.push(e[t]);this.repeatShowUIByType(a,t)}static gameProcessUI3(t){let e=[].concat(this.jsonConfig.gameProcess_setting);e.splice(0,e.indexOf(3)+1);let a=[];for(let t=0;t<e.length;t++)a.push(e[t]);this.repeatShowUIByType(a,t)}static repeatShowUIByType(t,e){t.length<=0?e&&e():this.showUIByType(t.shift(),()=>{this.repeatShowUIByType(t,e)})}static showUIByType(t,e){switch(t){case 4:this.showMiddleNativeUI(e);break;case 5:this.showBoxUI(e);break;case 6:this.isAccountLateTime?y.showVideo(null,e):e&&e();break;case 7:y.showGamePortalAd(e);break;default:e&&e()}}static showFDHomeUI(){Laya.Scene.open(r.FDHomeUI,!1)}static closeFDHomeUI(){Laya.Scene.close(r.FDHomeUI)}static showPrivacyUI(t){Laya.Scene.open(r.PrivacyUI,!1,{ccb:t})}static showBoxUI(t){Laya.Scene.open(r.Box,!1,{ccb:t})}static showMiddleNativeUI(t,e=!1){y.shareNativeAd.isAllError?t&&t():Laya.Scene.open(r.MiddleNativeUI,!1,{ccb:t,hidePanel:e})}static closeMiddleNativeUI(){Laya.Scene.close(r.MiddleNativeUI)}static showBannerNativeUI(t){y.shareNativeAd.isAllError?t&&t():this.jsonConfig.is_botNativeAd?Laya.Scene.open(r.BannerNativeUI,!1,{ccb:t}):t&&t()}static closeBannerNativeUI(){Laya.Scene.close(r.BannerNativeUI)}static showGridNativeUI(t){y.shareNativeAd.isAllError?t&&t():Laya.Scene.open(r.GridNativeUI,!1,{ccb:t})}static closeGridNativeUI(){Laya.Scene.close(r.GridNativeUI)}static showGiftBoxUI(t,e,a,i){Laya.Scene.open(r.GiftBoxUI,!1,{ccb:i,giftType:t,fromId:e,gameUIIndex:a})}static get allowScene(){if(Laya.Browser.onQGMiniGame){let t=Laya.Browser.window.wx.getLaunchOptionsSync().scene.toString();return-1!=this.jsonConfig.sceneList.split(",").indexOf(t)}return!0}static getConfig(t){console.log("wxsdk初始化"),window.wxsdk.init({version:"1.0.0",appid:"444",secret:"bzma4oa1xpcekrdhgkpfpfesndohdi4o",share:{title:"你能过得了这一关吗？",image:"https://game-oss.smallshark.cn/game/20211119/1216327431258.jpg?imageslim"}}),window.wxsdk.onInit(()=>{console.log("wxsdk初始化成功:",window.wxsdk.user),this.jsonConfig=window.wxsdk.conf,this.jsonConfig.is_late||(this.jsonConfig.is_nextBtnLate=!1,this.jsonConfig.is_startBtnLate=!1,this.jsonConfig.gameProcess_setting=[1,2,3],this.jsonConfig.is_touchMoveNativeAd=!1,this.jsonConfig.level_nativeType=2,this.jsonConfig.Button_clickpop=0,this.jsonConfig.Button_isinvalid=0,this.jsonConfig.Reward_interface_delayed=0,this.jsonConfig.Second_the_up=0,this.jsonConfig.Close_thepage=0,this.jsonConfig.Super_giftbag=0,this.jsonConfig.Button_isinvalid2=0,this.jsonConfig.Reward_interface_delayed2=0,this.jsonConfig.ADplacement=0,this.jsonConfig.Touchnative=0,this.jsonConfig.Touchnative2=0,this.jsonConfig.Touchnative3=0),console.log("config:",this.jsonConfig),y.initAllAd(),localStorage.getItem("showPrivacy")?t&&t():this.showPrivacyUI(t)}),window.wxsdk.login()}}m.version="1.0.0",m.wuchuProgressValue=0,m.wuchuProgressStepAdd=.1,m.wuchuProgressFrameSub=.0032,m.gameTime=0,m.gameCount=1,m.nativeMissTouched=!1,m.gameProcessIndex=0,m.hadClickStart=!1,m.hadShowHomeGiftBox=!1,m.gameGiftTimeArr=[],m.gameGiftBoxOCB=null,m.gameGiftBoxCCB=null,m.hadClickBackBtn=!1,m.hadShowBackGiftBox=!1,function(t){t.BannerNativeUI="FDScene/BannerNativeUI.scene",t.Box="FDScene/Box.scene",t.FDHomeUI="FDScene/FDHomeUI.scene",t.GridNativeUI="FDScene/GridNativeUI.scene",t.MiddleNativeUI="FDScene/MiddleNativeUI.scene",t.PrivacyUI="FDScene/PrivacyUI.scene",t.GiftBoxUI="FDScene/GiftBoxUI.scene"}(r||(r={})),function(t){t[t.Box1=0]="Box1",t[t.Box2=1]="Box2",t[t.Box3=2]="Box3"}(h||(h={})),function(t){t[t.From_Home=0]="From_Home",t[t.From_Game=1]="From_Game",t[t.From_Finish=2]="From_Finish"}(l||(l={}));class g extends Laya.Scene{constructor(){super(),this.touchStartPosX=0}onOpened(){g.Share=this,this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),Laya.timer.frameLoop(1,this,this.myUpdate),this.gradeNum.value=a.getPlayerData().grade.toString(),o.addClickEvent(this.giveupBtn,this,this.giveupBtnCB),this.touchBtn.on(Laya.Event.MOUSE_DOWN,this,this.touchStart),this.touchBtn.on(Laya.Event.MOUSE_MOVE,this,this.touchMove),this.touchBtn.on(Laya.Event.MOUSE_UP,this,this.touchEnd),m.inGame(()=>{u.Share.isPause=!0},()=>{u.Share.isPause=!1})}onClosed(){Laya.timer.clearAll(this)}giveupBtnCB(){u.Share.gameOver(!1)}touchStart(t){u.Share.isStartGame=!0,this.guideAni.visible=!1;let e=t.stageX;this.touchStartPosX=e}touchMove(t){let e=t.stageX;Math.abs(e-this.touchStartPosX)<20||(e-this.touchStartPosX>0?u.Share._playerCrl.moveDir=-1:u.Share._playerCrl.moveDir=1,this.touchStartPosX=e)}touchEnd(t){u.Share._playerCrl.moveDir=0}fixPlayerHp(){if(!u.Share._player)return;let t=new Laya.Vector4(0,0,0),e=u.Share._player.transform.position.clone();e.y+=2.5,u.Share._camera.viewport.project(e,u.Share._camera.projectionViewMatrix,t),this.playerHp.pos(t.x/Laya.stage.clientScaleX,t.y/Laya.stage.clientScaleY),this.playerHp.value=u.Share._playerCrl.hp/u.Share._playerCrl.hpMax,this.playerHp.getChildByName("num").value=u.Share._playerCrl.hp.toString()}fixEnemyHp(){if(!u.Share._enemy)return;let t=new Laya.Vector4(0,0,0),e=u.Share._enemy.transform.position.clone();e.y+=2.5,u.Share._camera.viewport.project(e,u.Share._camera.projectionViewMatrix,t),this.enemyHp.pos(t.x/Laya.stage.clientScaleX,t.y/Laya.stage.clientScaleY),this.enemyHp.value=u.Share._enemyCrl.hp/u.Share._enemyCrl.hpMax,this.enemyHp.getChildByName("num").value=u.Share._enemyCrl.hp.toString()}createPlayerDmg(t){let e=new Laya.FontClip("gameUI/yxz_sz_2.png","0123456789+-");e.anchorX=.5,e.anchorY=.5,e.value="-"+t.toString(),this.addChild(e);let a=new Laya.Vector4(0,0,0),i=u.Share._player.transform.position.clone();i.y+=3.5,u.Share._camera.viewport.project(i,u.Share._camera.projectionViewMatrix,a),e.pos(a.x/Laya.stage.clientScaleX,a.y/Laya.stage.clientScaleY),o.tMove2D(e,e.x,e.y-150,1e3,()=>{e.destroy()})}createEnemyDmg(t){let e=new Laya.FontClip("gameUI/yxz_sz_1.png","0123456789+-");e.anchorX=.5,e.anchorY=.5,e.value="-"+t.toString(),this.addChild(e);let a=new Laya.Vector4(0,0,0),i=u.Share._enemy.transform.position.clone();i.y+=3.5,u.Share._camera.viewport.project(i,u.Share._camera.projectionViewMatrix,a),e.pos(a.x/Laya.stage.clientScaleX,a.y/Laya.stage.clientScaleY),o.tMove2D(e,e.x,e.y-150,1e3,()=>{e.destroy()})}myUpdate(){this.fixPlayerHp(),this.fixEnemyHp()}}class p extends Laya.Script{constructor(){super(),this.myOwner=null,this.hpMax=10,this.hp=10,this.powerMax=10,this.power=10,this.moveDir=0,this.speed=.08,this.canMove=!0,this.hadLeg=!1,this.isPlayer=!1}onAwake(){this.myOwner=this.owner}initData(t,e,a=!1){if(this.isPlayer=a,this.hpMax=t,this.hp=t,this.powerMax=e,this.power=e,this.myOwner.getChildByName("FLegNode").numChildren>0||this.myOwner.getChildByName("BLegNode").numChildren>0){let t=this.myOwner.transform.position.clone();t.y+=1.8,this.myOwner.transform.position=t,this.hadLeg=!0}}moveX(){if(u.Share.isGameOver||!this.canMove)return;let t=this.speed;this.hadLeg||(t*=.5),this.moveDir>0?this.myOwner.transform.translate(new Laya.Vector3(t,0,0),!1):this.moveDir<0&&this.myOwner.transform.translate(new Laya.Vector3(-t,0,0),!1)}hurtCB(t){if(u.Share.isPause)return;this.canMove=!1;let e=this.myOwner.transform.position.clone();if(e.x+=this.isPlayer?4:-4,o.TmoveTo(this.myOwner,200,e,()=>{this.canMove=!0}),this.isPlayer?g.Share.createPlayerDmg(t):g.Share.createEnemyDmg(t),this.hp-=t,this.hp<=0){this.hp=0,u.Share.gameOver(!this.isPlayer);let t=this.myOwner.transform.position.clone();t.y=1,t.z-=1.5,o.TmoveTo(this.myOwner,800,t,null);let e=this.myOwner.transform.rotationEuler.clone();return e.x=this.isPlayer?-90:90,void o.RotateTo(this.myOwner,800,e,null)}}onUpdate(){if(!u.Share.isGameOver&&u.Share.isStartGame&&!u.Share.isPause)if(this.moveX(),this.myOwner.transform.position.x<-30){let t=this.myOwner.transform.position.clone();t.x=-30,this.myOwner.transform.position=t}else if(this.myOwner.transform.position.x>30){let t=this.myOwner.transform.position.clone();t.x=30,this.myOwner.transform.position=t}}}class u{constructor(){this.camStartPos=new Laya.Vector3(0,0,0),this.camStartRotation=null,this._cameraCrl=null,this.startCamField=60,this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this.isFinish=!1,this.isMeet=!1,this._levelNode=null,this._player=null,this._playerCrl=null,this._enemy=null,this._enemyCrl=null,this.playerHp=10,this.playerPower=10,this.enemyHp=10,this.enemyPower=10,Laya.Browser.onQGMiniGame||localStorage.clear(),u.Share=this,a.getPlayerData(),Laya.Scene.open("MyScenes/LoadingUI.scene")}initScene(){Laya.Scene3D.load(i.UnityPath+"SampleScene.ls",Laya.Handler.create(this,this.onLoadScene))}onLoadScene(t){Laya.Scene.open("MyScenes/StartUI.scene"),this._scene=Laya.stage.addChild(t),Laya.stage.setChildIndex(this._scene,0),this._camera=this._scene.getChildByName("Main Camera"),this._light=this._scene.getChildByName("Directional Light"),this._light.shadowMode=Laya.ShadowMode.SoftLow,this._light.shadowDistance=100,this._light.shadowResolution=1024,this._light.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,this.camStartPos=this._camera.transform.position.clone(),this.camStartRotation=this._camera.transform.rotation.clone(),this._camera.fieldOfView=this.startCamField,this._cameraCrl=this._camera.addComponent(n),this._levelNode=this._scene.addChild(new Laya.Sprite3D)}gameStart(t,e,a){this._player=Laya.Sprite3D.instantiate(t,this._levelNode,!1),this._player.transform.position=new Laya.Vector3(10,1,0),this._playerCrl=this._player.addComponent(p),this._playerCrl.initData(e,a,!0),this.createEnemy(),Laya.timer.frameLoop(1,this,this.checkColl),Laya.Scene.open("MyScenes/GameUI.scene")}createEnemy(){let t=u.Share._scene.getChildByName("BodyNode").getChildAt(o.GetRandom(0,5));this._enemy=Laya.Sprite3D.instantiate(t,this._levelNode,!1,new Laya.Vector3(0,0,0)),this._enemy.transform.position=new Laya.Vector3(-10,1,0),this._enemyCrl=this._enemy.addComponent(p),this._enemyCrl.moveDir=1,this._enemy.active=!0,this._enemy.transform.rotate(new Laya.Vector3(0,180,0),!0,!1);for(let t=0;t<5;t++)this.createEnemyItems(t);let e=o.GetRandom(10,30);this._enemyCrl.initData(a.getPlayerData().grade>=3?e:10,o.GetRandom(1,10))}createEnemyItems(t){let e=0,a=null,i=null,s=null;0==t?s=this._enemy.getChildByName("HeadNode"):1==t?s=this._enemy.getChildByName("WingNode"):2==t?s=this._enemy.getChildByName("TailNode"):3==t?s=this._enemy.getChildByName("FLegNode"):4==t&&(s=this._enemy.getChildByName("BLegNode")),a=this._scene.getChildByName(o.getRandomItemInArr(["HeadNode","LegNode","TailNode","WingsNode"])),e=o.GetRandom(0,a.numChildren-1),i=a.getChildAt(e);let n=Laya.Sprite3D.instantiate(i,s,!1,new Laya.Vector3(0,0,0));n.transform.localPosition=new Laya.Vector3,n.transform.localRotationEuler=new Laya.Vector3,n.active=!0}checkColl(){if(this.isGameOver||!this._player||!this._enemy||!this._playerCrl.canMove||!this._enemyCrl.canMove||!this.isStartGame)return;let t=this._player.transform.position.x,e=this._enemy.transform.position.x;if(Math.abs(t-e)<=4){i.DoVibrate(),s.instance.playSoundEffect("Hurt.mp3");let t=o.GetRandom(2,6),e=o.GetRandom(1,4);a.getPlayerData().grade>=3?(t*=1.5,e*=1.5):(e=1,t=3),this._playerCrl.hurtCB(Math.floor(e)),this._enemyCrl.hurtCB(Math.floor(t)),this.createHitFX()}Math.abs(t-e)<=6&&(this.isMeet=!0)}createHitFX(){let t=this._scene.getChildByName("T_Hit_1"),e=new Laya.Vector3;e.x=(u.Share._player.transform.position.x+u.Share._enemy.transform.position.x)/2,e.y=2.3,this._scene.getChildByName("T_Hit_1").transform.position=e,this._scene.getChildByName("T_Hit_1").transform.setWorldLossyScale(new Laya.Vector3(10,10,10)),this._scene.getChildByName("T_Hit_1").active=!0,t.particleSystem.play(),Laya.timer.once(300,this,()=>{this._scene.getChildByName("T_Hit_1").transform.position=new Laya.Vector3(0,1e5,0)})}createWinFX(){let t=Laya.Sprite3D.instantiate(this._scene.getChildByName("T_Confetti"),this._levelNode,!1),e=new Laya.Vector3;e.x=(u.Share._player.transform.position.x+u.Share._enemy.transform.position.x)/2,e.z+=2,t.transform.position=e,t.transform.setWorldLossyScale(new Laya.Vector3(3,3,3)),t.active=!0,Laya.timer.once(3e3,this,()=>{t&&t.destroy()})}gameOver(t){this.isGameOver||(Laya.timer.clearAll(this),i.DoVibrate(!1),t?(s.instance.playSoundEffect("Win.mp3"),this.createWinFX()):s.instance.playSoundEffect("Lose.mp3"),this.isWin=t,this.isGameOver=!0,this.isStartGame=!1,this.isPause=!1,Laya.Scene.close("MyScenes/GameUI.scene"),m.gameOver(()=>{Laya.timer.once(2e3,this,()=>{Laya.Scene.open("MyScenes/FinishUI.scene",!1)})}))}restartGame(){this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this._camera.fieldOfView=this.startCamField,this.isFinish=!1,this.isMeet=!1,this._camera.transform.position=this.camStartPos,this._camera.transform.rotation=this.camStartRotation,this._levelNode.destroyChildren()}}class L extends Laya.Scene{constructor(){super(),this.adData=null,this.ccb=null,this.hadClick=!1,this.onShowCB=null}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight);let e=m.jsonConfig.account_nativeScale;this.root.scale(e,e),t&&t.ccb&&(this.ccb=t.ccb),this.closeBtn.on(Laya.Event.CLICK,this,this.closeBtnCB),this.initNative(),Laya.timer.loop(1e3*m.jsonConfig.account_refBotNativeAd,this,()=>{this.initNative()}),this.onShowCB=(()=>{this.hadClick&&this.close()}),y.oppoPlatform&&Laya.Browser.window.qg.onShow(this.onShowCB)}onClosed(t){y.oppoPlatform&&this.onShowCB&&Laya.Browser.window.qg.offShow(this.onShowCB),Laya.timer.clearAll(this),y.shareNativeAd.hideAd(this.adData.adId),this.ccb&&this.ccb()}initNative(){return __awaiter(this,void 0,void 0,function*(){this.hadClick=!1,this.adData=(yield y.shareNativeAd.showAd()).adInfo,this.adData?(this.pic.skin=this.adData.imgUrlList[0]?this.adData.imgUrlList[0]:this.adData.iconUrlList[0],this.pic.off(Laya.Event.CLICK,this,this.adBtnCB),this.pic.on(Laya.Event.CLICK,this,this.adBtnCB),m.jsonConfig.is_touchMoveNativeAd&&m.isAccountLateTime&&!m.nativeMissTouched&&(this.pic.off(Laya.Event.MOUSE_MOVE,this,this.adBtnCB),this.pic.on(Laya.Event.MOUSE_MOVE,this,this.adBtnCB,[!0]))):this.close()})}adBtnCB(t=!1){this.hadClick||(this.hadClick=!0,y.shareNativeAd.clickAd(this.adData.adId),t&&m.setNativeMissTouched())}closeBtnCB(){m.jsonConfig.is_topNativeAdCloseBtnLate&&m.isAccountLateTime&&!m.nativeMissTouched?this.adBtnCB(!0):this.close()}}class f extends Laya.Scene{constructor(){super(...arguments),this.progressValue=0,this.hadShowBanner=!1,this.missTouchProgressArr=[],this.onShowCB=null}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(t){t&&t.ccb&&(this.closeCB=t.ccb),this.btnPress.on(Laya.Event.CLICK,this,this.onPress),Laya.timer.frameLoop(1,this,this.reFreshUI),this.missTouchProgressArr=[].concat(m.jsonConfig.threshold_sceneLateProgress);for(let t=0;t<this.missTouchProgressArr.length;t++)this.missTouchProgressArr[t]/=100;Laya.timer.once(500,this,()=>{this.onShowCB=(()=>{this.close()}),y.oppoPlatform&&Laya.Browser.window.qg.onShow(this.onShowCB)}),y.hideBanner(),m.closeBannerNativeUI()}onClosed(){y.oppoPlatform&&this.onShowCB&&Laya.Browser.window.qg.offShow(this.onShowCB),Laya.timer.clearAll(this),0==m.jsonConfig.type_sceneLateShowAd?y.hideBanner():1==m.jsonConfig.type_sceneLateShowAd&&m.closeBannerNativeUI(),this.closeCB&&this.closeCB()}onPress(){if(this.progressValue+=m.jsonConfig.add_sceneLateProgress/100,Laya.Tween.to(this.btnPress,{scaleX:1.2,scaleY:1.2},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.btnPress,{scaleX:1,scaleY:1},100,null)})),this.progressValue>=this.missTouchProgressArr[0]&&!this.hadShowBanner){if(this.missTouchProgressArr.shift(),this.hadShowBanner=!0,!m.isAccountLateTime)return void this.close();0==m.jsonConfig.type_sceneLateShowAd?y.showBanner():1==m.jsonConfig.type_sceneLateShowAd&&m.showBannerNativeUI(),Laya.timer.once(2e3,this,()=>{0==m.jsonConfig.type_sceneLateShowAd?y.hideBanner():1==m.jsonConfig.type_sceneLateShowAd&&m.closeBannerNativeUI(),this.hadShowBanner=!1,this.missTouchProgressArr.length<=0&&this.close()})}Laya.Tween.to(this.imgSushi,{rotation:30},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.imgSushi,{rotation:0},100)})),this.pressBar.value=this.progressValue}reFreshUI(){this.progressValue-=m.jsonConfig.reduction_sceneLateProgress/100/60,this.progressValue<0&&(this.progressValue=0),this.pressBar.value=this.progressValue,this.light.rotation+=1}}class w{static addClickEvent(t,e,a,i,s){if(t.offAllCaller(e),t instanceof Laya.Button&&!s){let s=t=>{a&&a.call(e,t)};t.on(Laya.Event.CLICK,e,s,[i])}else{let s=60,o=1,n=t.scaleX*o,r=t.scaleY*o,h=.9*o,l=!1,d=e=>{l=!0,Laya.Tween.to(t,{scaleX:h,scaleY:h},s)};t.on(Laya.Event.MOUSE_DOWN,e,d,[i]);let c=i=>{0!=l&&(l=!1,Laya.Tween.to(t,{scaleX:n,scaleY:r},s,null,new Laya.Handler(e,()=>{a&&a.call(e,i)})))};t.on(Laya.Event.MOUSE_UP,e,c,[i]);let y=e=>{Laya.Tween.to(t,{scaleX:n,scaleY:r},s)};t.on(Laya.Event.MOUSE_OUT,e,y,[i])}}}class C extends Laya.Scene{constructor(){super()}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),w.addClickEvent(this.privacyBtn,this,this.privacyBtnCB),w.addClickEvent(this.moreBtn,this,this.moreBtnCB),w.addClickEvent(this.deskTopBtn,this,this.deskTopBtnCB),this.deskTopBtn.visible=m.jsonConfig.account_addDesktop,this.moreBtn.visible=m.jsonConfig.is_homeGameBtn,this.privacyBtn.visible=m.jsonConfig.is_agreement}onClosed(t){}privacyBtnCB(){m.showPrivacyUI()}moreBtnCB(){y.showGamePortalAd()}deskTopBtnCB(){y.oppoPlatform&&Laya.Browser.window.qg.hasShortcutInstalled({success:()=>{Laya.Browser.window.qg.installShortcut({success:function(){}})}})}}class B extends Laya.Scene{constructor(){super(),this.ccb=null,this.adData=null,this.hadClick=!1,this.hadWuchu=!1,this.giftType=0,this.fromId=0,this.gameUIIndex=0,this.onShowCB=null}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.rotateLoop(),t&&t.ccb&&(this.ccb=t.ccb),t&&t.giftType&&(this.giftType=t.giftType),t&&t.fromId&&(this.fromId=t.fromId),t&&t.gameUIIndex&&(this.gameUIIndex=t.gameUIIndex);for(let t=0;t<this.titleNode.numChildren;t++)this.titleNode.getChildAt(t).visible=t==this.giftType,this.iconNode.getChildAt(t).visible=t==this.giftType;w.addClickEvent(this.openBtn,this,this.openBtnCB),w.addClickEvent(this.adBtn,this,this.adBtnCB),w.addClickEvent(this.closeBtn,this,this.closeBtnCB),w.addClickEvent(this.closeNativeBtn,this,this.closeNativeBtnCB),this.initNative(),this.onShowCB=(()=>{this.hadClick&&this.initNative()}),y.oppoPlatform&&Laya.Browser.window.qg.onShow(this.onShowCB),1==m.jsonConfig.ADplacement&&(this.root.centerY=50,this.btnNode.bottom=320)}onClosed(){y.oppoPlatform&&this.onShowCB&&Laya.Browser.window.qg.offShow(this.onShowCB),Laya.timer.clearAll(this),y.shareNativeAd.hideAd(this.adData.adId),this.ccb&&this.ccb()}rotateLoop(){this.light.rotation=0,Laya.Tween.to(this.light,{rotation:360},3e3,null,new Laya.Handler(this,()=>{this.rotateLoop()}))}openBtnCB(){y.showVideo(null,null)}closeBtnCB(){0==this.fromId?m.jsonConfig.Reward_interface_delayed&&(this.hadWuchu&&m.jsonConfig.Touchnative||!this.hadWuchu)&&this.adBtnCB(!0):1==this.fromId?m.jsonConfig.Close_thepage[this.gameUIIndex]&&(this.hadWuchu&&m.jsonConfig.Touchnative2[this.gameUIIndex]||!this.hadWuchu)&&this.adBtnCB(!0):2==this.fromId&&m.jsonConfig.Reward_interface_delayed2&&(this.hadWuchu&&m.jsonConfig.Touchnative3||!this.hadWuchu)&&this.adBtnCB(!0),this.close()}initNative(){return __awaiter(this,void 0,void 0,function*(){if(this.hadClick=!1,this.adData=(yield y.shareNativeAd.showAd()).adInfo,!this.adData)return this.root.visible=!1,void(this.adBtn.visible=!1);this.pic.skin=this.adData.imgUrlList[0]?this.adData.imgUrlList[0]:this.adData.iconUrlList[0],this.desc.text=this.adData.desc,this.pic.off(Laya.Event.CLICK,this,this.adBtnCB),this.pic.on(Laya.Event.CLICK,this,this.adBtnCB),m.jsonConfig.is_touchMoveNativeAd&&m.isAccountLateTime&&!m.nativeMissTouched&&(this.pic.off(Laya.Event.MOUSE_MOVE,this,this.adBtnCB),this.pic.on(Laya.Event.MOUSE_MOVE,this,this.adBtnCB,[!0]))})}adBtnCB(t=!1){!this.hadClick&&this.adData&&(this.hadClick=!0,y.shareNativeAd.clickAd(this.adData.adId),t&&(this.hadWuchu||(this.hadWuchu=!0),m.setNativeMissTouched()))}closeNativeBtnCB(){m.jsonConfig.is_topNativeAdCloseBtnLate&&m.isAccountLateTime&&!m.nativeMissTouched?this.adBtnCB(!0):this.close()}}class v extends Laya.Scene{constructor(){super(),this.adData=null,this.ccb=null,this.hadClick=!1}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.root.right=m.jsonConfig.pos_iconNativeAd[0],this.root.bottom=m.jsonConfig.pos_iconNativeAd[1];let e=m.jsonConfig.icon_nativeScale;this.root.scale(e,e),t&&t.ccb&&(this.ccb=t.ccb),this.closeBtn.on(Laya.Event.CLICK,this,this.closeBtnCB),this.initNative(),Laya.timer.loop(1e3*m.jsonConfig.account_refIconNativeAd,this,()=>{y.shareNativeAd.hideAd(this.adData.adId),this.initNative()})}onClosed(t){Laya.timer.clearAll(this),y.shareNativeAd.hideAd(this.adData.adId),this.hadClick&&Laya.timer.once(100,this,()=>{m.showGridNativeUI()}),this.ccb&&this.ccb()}initNative(){return __awaiter(this,void 0,void 0,function*(){this.hadClick=!1,this.adData=(yield y.shareNativeAd.showAd()).adInfo,this.adData?(this.pic.skin=this.adData.imgUrlList[0]?this.adData.imgUrlList[0]:this.adData.iconUrlList[0],this.pic.off(Laya.Event.CLICK,this,this.adBtnCB),this.pic.on(Laya.Event.CLICK,this,this.adBtnCB),m.jsonConfig.is_touchMoveNativeAd&&m.isAccountLateTime&&!m.nativeMissTouched&&(this.pic.off(Laya.Event.MOUSE_MOVE,this,this.adBtnCB),this.pic.on(Laya.Event.MOUSE_MOVE,this,this.adBtnCB,[!0]))):this.close()})}adBtnCB(t=!1){this.hadClick||(this.hadClick=!0,y.shareNativeAd.clickAd(this.adData.adId),t&&m.setNativeMissTouched(),this.close())}closeBtnCB(){m.jsonConfig.is_topNativeAdCloseBtnLate&&m.isAccountLateTime&&!m.nativeMissTouched?this.adBtnCB(!0):this.close()}}class S extends Laya.Scene{constructor(){super(),this.adData=null,this.ccb=null,this.hadClick=!1,this.onShowCB=null}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),t&&t.ccb&&(this.ccb=t.ccb),t&&t.hidePanel&&(this.myPanel.visible=!1),this.closeBtn.on(Laya.Event.CLICK,this,this.closeBtnCB),this.adBtn.on(Laya.Event.CLICK,this,this.adBtnCB),this.onShowCB=(()=>{this.hadClick&&this.close()}),y.oppoPlatform&&Laya.Browser.window.qg.onShow(this.onShowCB),y.hideBanner(),m.closeBannerNativeUI(),this.init()}onClosed(t){y.oppoPlatform&&this.onShowCB&&Laya.Browser.window.qg.offShow(this.onShowCB),Laya.timer.clearAll(this),y.shareNativeAd.hideAd(this.adData.adId),this.ccb&&this.ccb()}init(){return __awaiter(this,void 0,void 0,function*(){this.adData=(yield y.shareNativeAd.showAd()).adInfo,this.adData?(this.pic.skin=this.adData.imgUrlList[0]?this.adData.imgUrlList[0]:this.adData.iconUrlList[0],this.desc.text=this.adData.desc,this.pic.off(Laya.Event.CLICK,this,this.adBtnCB),this.pic.on(Laya.Event.CLICK,this,this.adBtnCB),m.jsonConfig.is_touchMoveNativeAd&&m.isAccountLateTime&&(this.pic.off(Laya.Event.MOUSE_MOVE,this,this.adBtnCB),this.pic.on(Laya.Event.MOUSE_MOVE,this,this.adBtnCB,[!0]))):this.close()})}adBtnCB(t=!1){this.hadClick||(this.hadClick=!0,y.shareNativeAd.clickAd(this.adData.adId),t&&m.setNativeMissTouched())}closeBtnCB(){m.jsonConfig.is_topNativeAdCloseBtnLate&&m.isAccountLateTime&&!m.nativeMissTouched?this.adBtnCB(!0):this.close()}}class I extends Laya.Scene{constructor(){super(),this.ccb=null}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),t&&t.ccb&&(this.ccb=t.ccb),this.disAgree.on(Laya.Event.CLICK,this,this.disAgreeCB),this.agree.on(Laya.Event.CLICK,this,this.agreeCB),this.scrollPanel.vScrollBarSkin="";this.ysText.text="重要须知:\n为了贯彻执行国家出版署颁布的《关于进-步严格管理切实防止未成年人沉迷网络游戏的通知》以及《关于贯彻实施<网络游戏管理暂行办法>的通知》，本公司特此制定本《游戏用户个人信息及隐私保护政策》。在此特别提醒用户仔细阅读本《游戏用户个人信息及隐私保护政策》中的各个条款(未成年人应当在其法定监护人陪同下阅读)，并选择接受或者不接受本《游戏用户个人信息及隐私保护政策》。\n1、一般而言，基于下列原因需要使用到用户的信息资源:\n(1)执行软件验证服务。\n(2)执行软件升级服务。\n(3)网络同步服务。\n(4)提高用户的使用安全性并提供客户支持。\n(5)因用户使用本软件特定功能或因用户要求本公司或合作单位提供特定服务时，本公司或合作单位则需要把用户的信息提供给与此相关联的第三方。\n(6)执行本公司的《隐私权声明》,用户可访问本公司网站查阅该声明。(7)其他有利于用户和本公司利益的。\n2、本公司注重对用户信息资源的保护，会使用各种安全技术和程序来保护用户信息资源不被未经授权的访问、使用和泄漏。除法律或政府要求或用户同意等原因外，本公司未经用户同意不向除合作单位以外的第三方公开、透露用户信息资源。但因下列原因而披露给第三方的除外:\n(1)基于国家法律法规的规定而对外披露;\n(2)应国家司法机关及其他有关机关基于法定程序的要求而披露;\n(3)为保护本公司或您的合法权益而披露;\n(4)在紧急情况下，为保护其他用户及第三方人身安全而披露;\n(5)用户本人或用户监护人授权披露的;\n(6)应用户监护人合法要求而提供用户个人身份信息时。\n3、用户同意:个人隐私信息是指那些能够对用户进行个人辨识或涉及个人通信的信息，包括下列信息:用户的姓名，有效身份证件号码，家庭地址、电话号码，IP地址，电子邮件地址信息。而非个人隐私信息是指用户对本软件的操作状态以及使用习惯等一些明确且客观反映在本公司服务器端的基本记录信息和其他一切个人隐私信息范围外的普通信息。\n以上内容自2021年11月1日更新后正式生效",this.disAgree.visible=m.jsonConfig.is_agreement}onClosed(t){this.ccb&&this.ccb()}disAgreeCB(){y.oppoPlatform&&Laya.Browser.window.qg.exitApplication({complete:t=>{console.log(t)}})}agreeCB(){localStorage.setItem("showPrivacy","1"),this.close()}}class _ extends Laya.Scene{constructor(){super(),this.freeSkin=[]}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.gradeNum.value=a.getPlayerData().grade.toString();let t=u.Share.isWin;this.winTitle.visible=t,this.loseTitle.visible=!t,this.nextBtn.visible=t,this.restartBtn.visible=!t,t&&a.unlockBody(),o.addClickEvent(this.nextBtn,this,this.closeCB),o.addClickEvent(this.restartBtn,this,this.closeCB);let e=a.getInvalidSkins();if(e.length<=0||!t)this.unlockNode.visible=!1;else{this.freeSkin=o.getRandomItemInArr(e);let t=this.unlockNode.getChildByName("icon"),i=this.unlockNode.getChildByName("name"),s="",n=this.freeSkin[1]+1<10?"0"+(this.freeSkin[1]+1):this.freeSkin[1]+1;0==this.freeSkin[0]?(s="items/Head_"+n+".png",i.text=a.getHeadName(this.freeSkin[1]),a.getDataByType(0)[this.freeSkin[1]]=1):1==this.freeSkin[0]?(s="items/Leg_"+n+".png",i.text=a.getLegName(this.freeSkin[1]),a.getDataByType(1)[this.freeSkin[1]]=1):2==this.freeSkin[0]?(s="items/Tail_"+n+".png",i.text=a.getTailName(this.freeSkin[1]),a.getDataByType(2)[this.freeSkin[1]]=1):3==this.freeSkin[0]&&(s="items/Wings_"+n+".png",i.text=a.getWingsName(this.freeSkin[1]),a.getDataByType(3)[this.freeSkin[1]]=1),t.skin=s,a.setPlayerData()}m.inFinish()}onClosed(){}closeCB(){m.backToHome(()=>{u.Share.isWin&&(a.getPlayerData().grade++,a.setPlayerData()),u.Share.restartGame(),this.close(),Laya.Scene.open("MyScenes/StartUI.scene",!1)})}}class A extends Laya.Script{constructor(){super()}onAwake(){let t=this.owner;t.y=t.y*Laya.stage.displayHeight/1334}}class x extends Laya.Scene{constructor(){super()}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),Laya.Browser.onQGMiniGame||localStorage.clear(),m.init(()=>{this.loadRes()}),Laya.timer.frameLoop(1,this,()=>{this.bar.value+=.01})}onClosed(){}loadSubpackage(){Laya.Browser.window.wx.loadSubpackage({name:"unity",success:t=>{this.loadRes()},fail:t=>{this.loadSubpackage()}}).onProgressUpdate(t=>{console.log("下载进度",t.progress),console.log("已经下载的数据长度",t.totalBytesWritten),console.log("预期需要下载的数据总长度",t.totalBytesExpectedToWrite)})}loadRes(){var t=[i.UnityPath+"SampleScene.ls"];Laya.loader.create(t,Laya.Handler.create(this,this.onComplete),Laya.Handler.create(this,this.onProgress))}onComplete(){m.beforeHome(()=>{u.Share.initScene()})}onProgress(t){}}class D extends Laya.Scene{constructor(){super(),this.totalDna=175,this.curHp=0,this.curPower=0,this.selectType=0,this.selectIndex=0,this.itemCount=0,this.hadShowAd=!1,this.canStart=!1,this.scene3D=null,this.light=null,this.camera=null,this.body=null,this.itemSp=null,this.choosBodyId=0,this.choosItemId=0,this.itemNode=null}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.gradeNum.value=a.getPlayerData().grade.toString(),Laya.timer.frameLoop(1,this,this.myUpdate),o.addClickEvent(this.nextBtn,this,this.nextBtnCB),o.addClickEvent(this.adBtn,this,this.adBtnCB),this.init3DScene(),this.initBodyList(),this.initItemList(),this.nextBtn.getChildAt(0).visible=a.getPlayerData().grade<=1}onClosed(){Laya.timer.clearAll(this),this.scene3D.destroy()}updateCurData(t,e,i){if(this.totalDna-=i,this.curHp+=t,this.curPower+=e,this.dnaNum.text=this.totalDna.toString(),this.hpNum.text=this.curHp.toString(),this.powerNum.text=this.curPower.toString(),this.nextBtn.gray=!1,this.canStart=!0,this.itemCount>=3){this.nextBtn.getChildAt(0).visible=a.getPlayerData().grade<=1}1==this.itemCount&&a.getPlayerData().grade<=1?(this.itemList.scrollTo(9),Laya.Tween.clearAll(this.finger),this.guide2()):2==this.itemCount&&a.getPlayerData().grade<=1&&(Laya.Tween.clearAll(this.finger),this.guide3())}init3DScene(){this.scene3D=Laya.stage.addChild(new Laya.Scene3D),Laya.stage.setChildIndex(this.scene3D,2),this.light=this.scene3D.addChild(new Laya.DirectionLight),this.light.color=new Laya.Vector3(1,1,1),this.light.transform.rotationEuler=new Laya.Vector3(0,180,0),this.camera=this.scene3D.addChild(new Laya.Camera(0,.1,1e3)),this.camera.transform.translate(new Laya.Vector3(0,0,-15)),this.camera.transform.rotate(new Laya.Vector3(0,180,0),!0,!1),this.camera.clearFlag=Laya.BaseCamera.CLEARFLAG_DEPTHONLY,this.camera.orthographicVerticalSize=20,this.camera.orthographic=!0,this.createBody(0)}createBody(t){this.body&&this.body.destroy();let e=u.Share._scene.getChildByName("BodyNode").getChildAt(t);this.body=Laya.Sprite3D.instantiate(e,this.scene3D,!1,new Laya.Vector3(0,0,0)),this.body.transform.position=new Laya.Vector3(0,4,0),this.body.active=!0}createItemSp(t,e){this.itemSp&&this.itemSp.destroy();let a=null,i=null;0==t?a=u.Share._scene.getChildByName("HeadNode"):1==t?a=u.Share._scene.getChildByName("LegNode"):2==t?a=u.Share._scene.getChildByName("TailNode"):3==t&&(a=u.Share._scene.getChildByName("WingsNode")),i=a.getChildAt(e),this.itemSp=Laya.Sprite3D.instantiate(i,this.scene3D,!1,new Laya.Vector3(0,0,0)),this.itemSp.transform.position=new Laya.Vector3(1,0,0),this.itemSp.getComponent(Laya.Animator).speed=0}initBodyList(){let t=[].concat(a.getPlayerData().bodyArr);for(let e=t.length-1;e>=0;e--)0==t[e]&&t.splice(e,1);this.bodyList.vScrollBarSkin="",this.bodyList.array=t,this.bodyList.repeatX=2,this.bodyList.repeatY=Math.floor(t.length/2),this.bodyList.renderHandler=Laya.Handler.create(this,this.onBodyListRender,null,!1)}onBodyListRender(t,e){if(e>=this.bodyList.array.length)return;var i=t.getChildByName("item");let s=i.getChildByName("selectIcon"),o=i.getChildByName("icon"),n=i.getChildByName("name");s.skin=e==this.choosBodyId?"selectUI/xz_dk_xzst3.png":"selectUI/xz_dk_xzst2.png";let r=e+1<10?"0"+(e+1).toString():(e+1).toString();o.skin="items/Body_"+r+".png",n.text=a.getBodyName(e),i.off(Laya.Event.CLICK,this,this.selectBody),i.on(Laya.Event.CLICK,this,this.selectBody,[e])}selectBody(t){s.instance.playSoundEffect("Click.mp3"),t!=this.choosBodyId&&(this.choosBodyId=t,this.createBody(t),this.initBodyList())}nextBtnCB(){if(this.bodyList.visible){this.bodyList.visible=!1,this.itemList.visible=!0,this.nextBtn.skin="selectUI/xz_btn_kszd.png",this.nextBtn.gray=!0,this.nextBtn.getChildAt(0).visible=!1,a.getPlayerData().grade<=1&&this.guide1()}this.canStart&&u.Share.gameStart(this.body,this.curHp,this.curPower)}createItem(t){this.itemNode&&this.itemNode.destroy();let e=u.Share._scene.getChildByName("BodyNode").getChildAt(t);this.itemNode=Laya.Sprite3D.instantiate(e,this.scene3D,!1,new Laya.Vector3(0,0,0)),this.itemNode.transform.position=new Laya.Vector3(0,4,0),this.itemNode.active=!0}updateItemList(){let t=[].concat(a.getPlayerData().headArr);t=(t=(t=t.concat(a.getPlayerData().legArr)).concat(a.getPlayerData().tailArr)).concat(a.getPlayerData().wingsArr),this.itemList.array=t}initItemList(){let t=[].concat(a.getPlayerData().headArr);t=(t=(t=t.concat(a.getPlayerData().legArr)).concat(a.getPlayerData().tailArr)).concat(a.getPlayerData().wingsArr),this.itemList.vScrollBarSkin="",this.itemList.array=t,this.itemList.repeatX=3,this.itemList.repeatY=Math.floor(t.length/3),this.itemList.renderHandler=Laya.Handler.create(this,this.onItemListRender,null,!1)}onItemListRender(t,e){if(e>=this.itemList.array.length)return;let i=0;var s=t.getChildByName("item");let o=s.getChildByName("icon"),n=s.getChildByName("name"),r=s.getChildByName("hpBar"),h=s.getChildByName("hpNum"),l=s.getChildByName("powerBar"),d=s.getChildByName("powerNum"),c=s.getChildByName("bottomBg"),y=c.getChildByName("dnaNum"),m=s.getChildByName("adBg"),g="",p=0;if(e<10){i=0,g="items/Head_"+((p=e)+1<10?"0"+(p+1).toString():(p+1).toString())+".png",n.text=a.getHeadName(p),r.value=a.getItemData().head[p][0]/20,h.value=a.getItemData().head[p][0],l.value=a.getItemData().head[p][1]/10,d.value=a.getItemData().head[p][1],y.value=a.getItemData().head[p][2],m.visible=0==a.getPlayerData().headArr[p],c.skin=this.totalDna>=a.getItemData().head[p][2]?"selectUI/xz_dk_xzbj3.png":"selectUI/xz_dk_xzbj2.png"}else if(e<20){i=1,g="items/Leg_"+((p=e-10)+1<10?"0"+(p+1).toString():(p+1).toString())+".png",n.text=a.getLegName(p),r.value=a.getItemData().leg[p][0]/20,h.value=a.getItemData().leg[p][0],l.value=a.getItemData().leg[p][1]/10,d.value=a.getItemData().leg[p][1],y.value=a.getItemData().leg[p][2],m.visible=0==a.getPlayerData().legArr[p],c.skin=this.totalDna>=a.getItemData().leg[p][2]?"selectUI/xz_dk_xzbj3.png":"selectUI/xz_dk_xzbj2.png"}else if(e<24){i=2,g="items/Tail_"+((p=e-20)+1<10?"0"+(p+1).toString():(p+1).toString())+".png",n.text=a.getTailName(p),r.value=a.getItemData().tail[p][0]/20,h.value=a.getItemData().tail[p][0],l.value=a.getItemData().tail[p][1]/10,d.value=a.getItemData().tail[p][1],y.value=a.getItemData().tail[p][2],m.visible=0==a.getPlayerData().tailArr[p],c.skin=this.totalDna>=a.getItemData().tail[p][2]?"selectUI/xz_dk_xzbj3.png":"selectUI/xz_dk_xzbj2.png"}else if(e<26){i=3,g="items/Wings_"+((p=e-24)+1<10?"0"+(p+1).toString():(p+1).toString())+".png",n.text=a.getWingsName(p),r.value=a.getItemData().wings[p][0]/20,h.value=a.getItemData().wings[p][0],l.value=a.getItemData().wings[p][1]/10,d.value=a.getItemData().wings[p][1],y.value=a.getItemData().wings[p][2],m.visible=0==a.getPlayerData().wingsArr[p],c.skin=this.totalDna>=a.getItemData().wings[p][2]?"selectUI/xz_dk_xzbj3.png":"selectUI/xz_dk_xzbj2.png"}o.skin=g,o.off(Laya.Event.MOUSE_DOWN,this,this.selecItemDown),o.off(Laya.Event.CLICK,this,this.selectItemUp),o.on(Laya.Event.MOUSE_DOWN,this,this.selecItemDown,[i,p]),o.on(Laya.Event.CLICK,this,this.selectItemUp,[i,p])}selecItemDown(t,e){s.instance.playSoundEffect("Click.mp3"),this.selectType=t,this.selectIndex=e,this.totalDna<this.getItemDataFromTypeIndex()[2]||0!=a.getDataByType(t)[e]&&(this.itemList.scrollBar.touchScrollEnable=!1,this.createItemSp(t,e),this.on(Laya.Event.MOUSE_MOVE,this,this.fullBtnMove),this.on(Laya.Event.MOUSE_UP,this,this.fullBtnEnd),Laya.Tween.clearAll(this.finger),this.finger.visible=!1)}selectItemUp(t,e){if(console.log("click"),0!=a.getDataByType(t)[e]);else{let i=()=>{a.getDataByType(t)[e]=1,a.setPlayerData(),this.updateItemList()};y.showVideo(i)}}fullBtnMove(){if(this.itemList.scrollBar.touchScrollEnable||!this.itemSp)return;this.itemSp.active=!0;let t=new Laya.Vector3(Laya.stage.mouseX,Laya.stage.mouseY-150,0);this.camera.convertScreenCoordToOrthographicCoord(t,t),t.z=0,this.itemSp.transform.position=t;let e=this.checkFixItemNode();e&&(this.itemSp.transform.rotationEuler=e.transform.rotationEuler.clone())}fullBtnEnd(){this.itemList.scrollBar.touchScrollEnable=!0,this.off(Laya.Event.MOUSE_MOVE,this,this.fullBtnMove),this.off(Laya.Event.MOUSE_UP,this,this.fullBtnEnd);let t=this.checkFixItemNode();t?this.addItemToBody(t):this.itemSp.destroy()}checkFixItemNode(){for(let t=0;t<this.body.numChildren;t++){let e=this.body.getChildAt(t),a=e.transform.position.clone(),i=this.itemSp.transform.position.clone();if(Laya.Vector3.distance(a,i)<=1)return e}return null}addItemToBody(t){this.itemCount++,s.instance.playSoundEffect("Get.mp3"),i.DoVibrate();let e=Laya.Sprite3D.instantiate(this.itemSp,t,!1);e.transform.localPosition=new Laya.Vector3,e.transform.localRotationEuler=new Laya.Vector3,e.getComponent(Laya.Animator).speed=1,this.itemSp.destroy(),this.updateCurData(this.getItemDataFromTypeIndex()[0],this.getItemDataFromTypeIndex()[1],this.getItemDataFromTypeIndex()[2]),this.updateItemList()}getItemDataFromTypeIndex(){let t=[];return 0==this.selectType?t=a.getItemData().head[this.selectIndex]:1==this.selectType?t=a.getItemData().leg[this.selectIndex]:2==this.selectType?t=a.getItemData().tail[this.selectIndex]:3==this.selectType&&(t=a.getItemData().wings[this.selectIndex]),t}adBtnCB(){y.showVideo(()=>{this.totalDna+=150,this.dnaNum.text=this.totalDna.toString(),this.adBtn.visible=!1,this.updateItemList()})}guide1(){this.finger.visible=!0,this.finger.pos(183,this.height-472),this.finger.scale(2,2),Laya.Tween.to(this.finger,{scaleX:1,scaleY:1},300,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.finger,{x:530,y:300},1e3,null,new Laya.Handler(this,()=>{this.guide1()}))}))}guide2(){this.finger.visible=!0,this.finger.pos(this.width/2,this.height-472),this.finger.scale(2,2),Laya.Tween.to(this.finger,{scaleX:1,scaleY:1},300,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.finger,{x:255,y:500},1e3,null,new Laya.Handler(this,()=>{this.guide2()}))}))}guide3(){this.finger.visible=!0,this.finger.pos(this.width/2,this.height-472),this.finger.scale(2,2),Laya.Tween.to(this.finger,{scaleX:1,scaleY:1},300,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.finger,{x:475,y:500},1e3,null,new Laya.Handler(this,()=>{this.guide3()}))}))}myUpdate(){}}class N extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.scaleLoop(this.myOwnwer,1.1,400)}scaleLoop(t,e,a){Laya.Tween.to(t,{scaleX:e,scaleY:e},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(t,{scaleX:1,scaleY:1},a,null,new Laya.Handler(this,()=>{this.scaleLoop(t,e,a)}))}))}}class P extends Laya.Scene{constructor(){super()}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),o.addClickEvent(this.startBtn,this,this.startBtnCB),o.addClickEvent(this.vibrateBtn,this,this.vibrateBtnCB),m.inHome()}onClosed(){}startBtnCB(){m.clickStart(()=>{this.close(),Laya.Scene.open("MyScenes/SelectUI.scene",!1)})}vibrateBtnCB(){i.isVibrate=!i.isVibrate,this.vibrateBtn.skin=i.isVibrate?"gameUI/zd_btn_1.png":"gameUI/zd_btn_2.png",this.vibrateBtn.getChildAt(0).text=i.isVibrate?"震动：开":"震动：关"}}class b extends Laya.Script{constructor(){super(),this.startY=0}onAwake(){this.myOwner=this.owner,this.startY=this.myOwner.y,this.startTween()}startTween(){Laya.Tween.to(this.myOwner,{y:this.startY+50},1e3,Laya.Ease.sineInOut,new Laya.Handler(this,()=>{Laya.Tween.to(this.myOwner,{y:this.startY},1e3,Laya.Ease.sineInOut,new Laya.Handler(this,()=>{this.startTween()}))}))}}class T{constructor(){}static init(){var t=Laya.ClassUtils.regClass;t("FanDong/BannerNativeUI.ts",L),t("FanDong/Box.ts",f),t("FanDong/FDHomeUI.ts",C),t("FanDong/GiftBoxUI.ts",B),t("FanDong/GridNativeUI.ts",v),t("FanDong/MiddleNativeUI.ts",S),t("FanDong/PrivacyUI.ts",I),t("View/FinishUI.ts",_),t("View/GameUI.ts",g),t("Libs/FixNodeY.ts",A),t("View/LoadingUI.ts",x),t("View/SelectUI.ts",D),t("Libs/ScaleLoop.ts",N),t("View/StartUI.ts",P),t("Mod/UpDownLoop.ts",b)}}T.width=750,T.height=1334,T.scaleMode="fixedwidth",T.screenMode="vertical",T.alignV="top",T.alignH="left",T.startScene="MyScenes/StartUI.scene",T.sceneRoot="",T.debug=!1,T.stat=!1,T.physicsDebug=!1,T.exportSceneToJson=!0,T.init();new class{constructor(){window.Laya3D?Laya3D.init(T.width,T.height):Laya.init(T.width,T.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=T.scaleMode,Laya.stage.screenMode=T.screenMode,Laya.stage.alignV=T.alignV,Laya.stage.alignH=T.alignH,Laya.URL.exportSceneToJson=T.exportSceneToJson,Laya.stage.useRetinalCanvas=!0,(T.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),T.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),T.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){new u}}}();