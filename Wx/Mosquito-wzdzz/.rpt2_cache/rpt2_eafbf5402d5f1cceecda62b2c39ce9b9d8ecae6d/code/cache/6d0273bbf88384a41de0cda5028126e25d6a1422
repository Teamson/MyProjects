{
  "code": "import PlayerDataMgr from \"../Libs/PlayerDataMgr\";\r\nimport WxApi from \"../Libs/WxApi\";\r\nimport SoundMgr from \"../Mod/SoundMgr\";\r\nimport GameLogic from \"./GameLogic\";\r\nexport default class PlayerBall extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.myOwner = null;\r\n        this.ball = null;\r\n        this.body = null;\r\n        this.myColorId = 0;\r\n        this.biggerFX = null;\r\n        this.smallFX = null;\r\n        this.kickFX = null;\r\n        this.playWinSound = false;\r\n    }\r\n    onEnable() {\r\n        this.myOwner = this.owner;\r\n        this.ball = this.myOwner.getChildAt(0);\r\n        this.body = this.ball.getComponent(Laya.Rigidbody3D);\r\n        this.body.enabled = false;\r\n        this.biggerFX = this.myOwner.getChildByName('BiggerFX');\r\n        this.smallFX = this.myOwner.getChildByName('SmallFX');\r\n        this.kickFX = this.myOwner.getChildByName('KickFX');\r\n    }\r\n    onDisable() {\r\n    }\r\n    setMyColor(id) {\r\n        this.myColorId = id;\r\n        let c = PlayerDataMgr.getFruitColor(id);\r\n        let ms = this.ball;\r\n        var material = new Laya.BlinnPhongMaterial();\r\n        material.shininess = 0.7;\r\n        material.albedoIntensity = 0.7;\r\n        ms.meshRenderer.material = material;\r\n        ms.meshRenderer.sharedMaterial.shininess = 0.01;\r\n        ms.meshRenderer.sharedMaterial.albedoIntensity = 0.7;\r\n        ms.meshRenderer.sharedMaterial.specularColor = new Laya.Vector4(0, 0, 0, 1);\r\n        ms.meshRenderer.sharedMaterial.albedoColor = new Laya.Vector4(c.r, c.g, c.b, c.a);\r\n    }\r\n    scaleBall(v) {\r\n        let s = this.myOwner.transform.getWorldLossyScale().clone();\r\n        s.x += v;\r\n        s.y += v;\r\n        s.z += v;\r\n        if (s.x < 1)\r\n            s.x = 1;\r\n        if (s.y < 1)\r\n            s.y = 1;\r\n        if (s.z < 1)\r\n            s.z = 1;\r\n        this.myOwner.transform.setWorldLossyScale(s);\r\n    }\r\n    playBiggerFX() {\r\n        this.biggerFX.particleSystem.play();\r\n    }\r\n    playSmallFX() {\r\n        this.smallFX.particleSystem.play();\r\n    }\r\n    playKickFX() {\r\n        this.kickFX.particleSystem.play();\r\n    }\r\n    onUpdate() {\r\n        if (this.ball.transform.position.z >= GameLogic.Share.totalDistance + 18 && !this.playWinSound) {\r\n            SoundMgr.instance.playSoundEffect('BowlingHit.mp3');\r\n            WxApi.DoVibrate();\r\n            this.playWinSound = true;\r\n        }\r\n        if (!GameLogic.Share.isStartGame && !GameLogic.Share.isGameOver) {\r\n            if (this.ball.transform.position.z >= GameLogic.Share.totalDistance + 30) {\r\n                GameLogic.Share.winCB();\r\n            }\r\n        }\r\n        if (!GameLogic.Share.isStartGame || GameLogic.Share.isGameOver)\r\n            return;\r\n        let pPos = GameLogic.Share._player.transform.position.clone();\r\n        pPos.z += 0.6;\r\n        this.myOwner.transform.position = pPos;\r\n        if (this.ball.transform.position.z > GameLogic.Share.totalDistance) {\r\n            GameLogic.Share.getDestination();\r\n        }\r\n    }\r\n}\r\n",
  "references": [
    "E:/LayaProjects/PoleRush/src/Libs/PlayerDataMgr.ts",
    "E:/LayaProjects/PoleRush/src/Libs/WxApi.ts",
    "E:/LayaProjects/PoleRush/src/Mod/SoundMgr.ts",
    "E:/LayaProjects/PoleRush/src/Crl/GameLogic.ts"
  ]
}
