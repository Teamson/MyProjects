!function(){"use strict";class e{constructor(){this.grade=1,this.coin=0,this.exitTime=0}}class t{static getPlayerData(){return localStorage.getItem("playerData")?null==this._playerData&&(this._playerData=JSON.parse(localStorage.getItem("playerData"))):(this._playerData=new e,localStorage.setItem("playerData",JSON.stringify(this._playerData))),this._playerData}static setPlayerData(){localStorage.setItem("playerData",JSON.stringify(this._playerData))}static changeCoin(e){this._playerData.coin+=e,this.setPlayerData()}static setExitTime(){this._playerData.exitTime=(new Date).getTime(),this.setPlayerData()}}t._playerData=null,t.powerMax=10,t.tempSkinId=-1,t.levelDataArr=[];class i{static LoginWx(e){if(!Laya.Browser.onWeiXin)return;let t=Laya.Browser.window.wx.getLaunchOptionsSync();Laya.Browser.window.wx.login({success(i){i.code&&(console.log("res.code:",i.code),e&&e(i.code,t.query))}})}static checkScope(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.getSetting({success:t=>{t.authSetting["scope.userInfo"]?console.log("已经授权"):(console.log("没有授权"),this.createScope(e))}})}static createScope(e){this.scopeBtn=Laya.Browser.window.wx.createUserInfoButton({type:"text",text:"",style:{left:e.x,top:e.y,width:e.width,height:e.height,lineHeight:40,backgroundColor:"#ffffff",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:0}}),this.scopeBtn.onTap(e=>{"getUserInfo:ok"==e.errMsg?(this.scopeBtn.destroy(),this.scopeBtn=null):"getUserInfo:fail auth deny"==e.errMsg&&(this.scopeBtn.destroy(),this.scopeBtn=null)})}static GetLaunchParam(e){Laya.Browser.onWeiXin&&(this.OnShowFun=e,e(this.GetLaunchPassVar()),Laya.Browser.window.wx.onShow(e=>{null!=this.OnShowFun&&this.OnShowFun(e),console.log("wx on show")}))}static GetLaunchPassVar(){return Laya.Browser.onWeiXin?Laya.Browser.window.wx.getLaunchOptionsSync():null}static WxOnHide(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onHide(e)}static WxOffHide(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offHide(e)}static WxOnShow(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(e)}static WxOffShow(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(e)}static httpRequest(e,t,i="get",a){var s=new Laya.HttpRequest;s.http.timeout=5e3,s.once(Laya.Event.COMPLETE,this,a),s.once(Laya.Event.ERROR,this,this.httpRequest,[e,t,i,a]),"get"==i?s.send(e+"?"+t,"",i,"text"):"post"==i&&s.send(e,JSON.stringify(t),i,"text")}static DoVibrate(e=!0){Laya.Browser.onWeiXin&&this.isVibrate&&(e?Laya.Browser.window.wx.vibrateShort():Laya.Browser.window.wx.vibrateLong())}static OpenAlert(e,t=2e3,i=!1){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.showToast({title:e,duration:t,mask:!1,icon:i?"success":"none"})}static NavigateApp(e,t,i,a,s){if(Laya.Browser.onWeiXin){Laya.Browser.window.wx.navigateToMiniProgram({appId:e,path:t,success(e){console.log("打开成功"),s()},fail(e){console.log("打开失败"),a()}})}}static preViewImage(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.previewImage({current:e,urls:[e]})}}i.UnityPath="LayaScene_SampleScene/Conventional/",i.openId="",i.version="1.0.0",i.isVibrate=!0,i.isMusic=!0,i.OnShowFun=null,i.scopeBtn=null,i.shareCallback=null,i.front_share_number=0,i.sceneId=0,i.gotOfflineBounes=!1,i.configData=null,i.shareTime=0,i.firstShare=!0,i.hadShowFriendUI=!1,i.launchGameUI=!1,i.firstStartGame=!1,i.isKillBossUI=!1,i.fromKillBossUI=!1,i.killbossCallback=null,i.gameNavCallback=null,i.gameNavOnHide=!1,i.isStartUI=!1,i.isAuditor=!1,i.shieldAppid=!1,i.tempGrade=1;class a{static calcDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static getWorldDis(e,t){let i=e.transform.position.clone(),a=t.transform.position.clone();return Laya.Vector3.distance(i,a)}static getDirectionAToB(e,t,i=!0){let a=e.transform.position.clone(),s=t.transform.position.clone(),n=new Laya.Vector3(0,0,0);return Laya.Vector3.subtract(s,a,n),i&&Laya.Vector3.normalize(n,n),n}static fixPosY(e,t=1334){return e*Laya.stage.displayHeight/t}static findNodeByName(e,t){let i=null,a=e=>{for(let s=0;s<e.numChildren;s++){if(e.getChildAt(s).name==t)return void(i=e.getChildAt(s));a(e.getChildAt(s))}};return a(e),i}static TmoveTo(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var o=e.transform.position;n.to(e.transform.position,{x:i.x,y:i.y,z:i.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=o)})},t,s,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToYZ(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var o=e.transform.position;return n.to(e.transform.position,{y:i.y,z:i.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=o)})},t,null,Laya.Handler.create(this,()=>{a&&a()})),n}static TmoveToX(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var o=e.transform.localPosition;n.to(e.transform.localPosition,{x:i.x,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=o)})},t,null,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToY(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var o=e.transform.localPosition;n.to(e.transform.localPosition,{y:i.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=o)})},t,s,Laya.Handler.create(this,()=>{a&&a()}))}static TmoveToWorld(e,t,i,a,s){if(!e.transform)return;let n=new Laya.Tween;var o=e.transform.position;n.to(e.transform.position,{y:i.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=o)})},t,null,Laya.Handler.create(this,()=>{a&&a()}))}static RotateWithPoint(e,t,i){let a=new Laya.Vector3,s=e.transform.localPosition.clone();return i=i*Math.PI/180,a.x=s.x*Math.cos(i)+(t.y*s.z-t.z*s.y)*Math.sin(i)+t.x*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a.y=s.y*Math.cos(i)+(t.x*s.z-t.z*s.x)*Math.sin(i)+t.y*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a.z=s.z*Math.cos(i)+(t.x*s.y-t.y*s.x)*Math.sin(i)+t.z*(t.x*s.x+t.y*s.y+t.z*s.z)*(1-Math.cos(i)),a}static RotateTo(e,t,i,a){var s=e.transform.rotationEuler;Laya.Tween.to(e.transform.rotationEuler,{x:i.x,y:i.y,z:i.z,update:new Laya.Handler(this,function(){e&&(e.transform.rotationEuler=s)})},t,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){a&&a()}))}static tMove2D(e,t,i,a,s){Laya.Tween.to(e,{x:t,y:i},a,null,new Laya.Handler(this,()=>{s&&s()}))}static scaleTo2D(e,t,i,a){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{a&&a()}))}static alphaTo2D(e,t,i,a){Laya.Tween.to(e,{alpha:t},i,null,new Laya.Handler(this,()=>{a&&a()}))}static updateNumber(e,t,i,a=!0,s,n){let o=e*t,r=Math.floor((o-e)/60);r=r<=0?1:r;let l=()=>{s?((e+=r)>=o&&(e=o,n&&n(),Laya.timer.clear(this,l)),a?i.text=e.toString():i.value=e.toString()):((o-=r)<=e&&(o=e,n&&n(),Laya.timer.clear(this,l)),a?i.text=o.toString():i.value=o.toString())};Laya.timer.frameLoop(1,this,l)}static loadJson(e,t){Laya.loader.load(e,Laya.Handler.create(this,t),null,Laya.Loader.JSON)}static objectShake(e,t=1,i=.7){var a=t,s=1,n=e.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(a>0){var t=new Laya.Vector3;Laya.Vector3.scale((o=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(o,r,0)),i,t),Laya.Vector3.add(n,t,t),e.transform.localPosition=t,a-=.02*s}else a=0,e.transform.localPosition=n,Laya.timer.clear(this,updateShake);var o,r})}static getRandomItemInArr(e){return e[Math.floor(Math.random()*e.length)]}static shuffleArr(e){let t=e.length;for(;t;){let i=Math.floor(Math.random()*t--);[e[i],e[t]]=[e[t],e[i]]}return e}static GetRandom(e,t,i=!0){let a=t-e,s=Math.random()*(a+1);return s+=e,i?Math.floor(s):s}static coinCollectAnim(e,t,i,a=10,s){let n=a;for(var o=0;o<a;o++){let a=Laya.Pool.getItemByClass("coin",Laya.Image);a.skin="startUI/zy_zs_1.png",a.x=e.x,a.y=e.y,i.addChild(a);let o=300+100*Math.random()-50;Laya.Tween.to(a,{x:a.x+250*Math.random()-125,y:a.y+250*Math.random()-125},o),Laya.timer.once(o+50,this,function(){Laya.Tween.to(a,{x:t.x,y:t.y},400,null,new Laya.Handler(this,function(){i.removeChild(a),Laya.Pool.recover("coin",a),0==--n&&s&&s()}))})}}static scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}static rotateLoop(e,t,i){Laya.Tween.to(e,{rotation:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:-t},2*i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:0},i,null,new Laya.Handler(this,()=>{this.rotateLoop(e,t,i)}))}))}))}static visibleDelay(e,t){e.visible=!1,Laya.timer.once(t,this,()=>{e.visible=!0})}static pointInPolygon(e,t){for(var i=e.x,a=e.y,s=!1,n=0,o=t.length-1;n<t.length;o=n++){var r=t[n].x,l=t[n].y,h=t[o].x,d=t[o].y;l>a!=d>a&&i<(h-r)*(a-l)/(d-l)+r&&(s=!s)}return s}static getSprite3DResByUrl(e,t,a=!1){let s=Laya.loader.getRes(i.UnityPath+e);return Laya.Sprite3D.instantiate(s,t,a,new Laya.Vector3(0,0,0))}static getRandomItemInArrWithoutSelf(e,t,i=1){let a=[].concat(t);return a.splice(a.indexOf(e),1),(a=this.shuffleArr(a)).slice(0,i)}static getBoundBox(e,t=!1){let i=e.getComponent(Laya.PhysicsCollider).colliderShape,a=e.transform.position.clone();a.x+=i.localOffset.x,a.y+=i.localOffset.y,a.z+=i.localOffset.z;let s=e.parent,n=1;s&&s.transform&&t&&(n=s.transform.localScaleZ);let o=new Laya.Vector3(a.x-i.sizeX/2,a.y-i.sizeY/2,a.z-i.sizeZ/2),r=new Laya.Vector3(a.x+i.sizeX/2,a.y+i.sizeY/2,a.z+i.sizeZ*n/2/2);return new Laya.BoundBox(o,r)}static getBoundBoxWithMinMax(e,t){return new Laya.BoundBox(e,t)}static addClickEvent(e,t,i,a,s){if(e.offAllCaller(t),e instanceof Laya.Button&&!s){let s=e=>{i&&i.call(t,e)};e.on(Laya.Event.CLICK,t,s,[a])}else{let s=60,n=1,o=e.scaleX*n,r=e.scaleY*n,l=.9*n,h=!1,d=t=>{h=!0,Laya.Tween.to(e,{scaleX:l,scaleY:l},s)};e.on(Laya.Event.MOUSE_DOWN,t,d,[a]);let c=a=>{0!=h&&(h=!1,Laya.Tween.to(e,{scaleX:o,scaleY:r},s,null,new Laya.Handler(t,()=>{i&&i.call(t,a)})))};e.on(Laya.Event.MOUSE_UP,t,c,[a]);let y=t=>{Laya.Tween.to(e,{scaleX:o,scaleY:r},s)};e.on(Laya.Event.MOUSE_OUT,t,y,[a])}}static getVector3(e,t,i){return new Laya.Vector3(Number(e),Number(t),Number(i))}}class s extends Laya.Script{constructor(){super()}onAwake(){this.myOwner=this.owner}onDisable(){}onUpdate(){}}class n extends Laya.Script{constructor(){super(),this.myOwner=null,this.coll=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner,this.coll=this.myOwner.getChildAt(0)}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.coll.transform.position.clone(),t=S.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,i.DoVibrate(),S.Share.updateMosquitoNum(S.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}class o extends Laya.Script{constructor(){super(),this.myOwner=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.myOwner.transform.position.clone(),t=S.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,i.DoVibrate(),S.Share.updateMosquitoNum(S.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}class r extends Laya.Script{constructor(){super(),this.myOwner=null,this.value="",this.type=1,this.plane=null,this.cxt=null,this.cav=null,this.calType=0,this.num=1,this.hadColl=!1,this.hadClear=!1,this.texture2d=null}onAwake(){this.myOwner=this.owner,this.plane=this.myOwner.getChildByName("Plane")}onDisable(){}init(e){if(this.type=e,"+"==this.value[0]){this.calType=0;let e=this.value.split("+");this.num=parseInt(e[1])}else if("-"==this.value[0]){this.calType=1;let e=this.value.split("-");this.num=parseInt(e[1])}else if("*"==this.value[0]){this.calType=2;let e=this.value.split("*");this.num=parseInt(e[1])}else if("/"==this.value[0]){this.calType=3;let e=this.value.split("/");this.num=parseInt(e[1])}if("*"==this.value[0]){let e=this.value.split("*");this.value="x"+e[1]}else if(-1!=this.value.search("/")){let e=this.value.split("/");this.value="÷"+e[1]}let t=this.plane.meshRenderer.material;this.cav=Laya.Browser.createElement("canvas"),this.cxt=this.cav.getContext("2d"),this.cav.width=256,this.cav.height=256,this.cxt.fillStyle="rgb(255,255,255)",this.cxt.font="bold 150px Arial",this.cxt.textAlign="center",this.cxt.textBaseline="center",this.cxt.fillText(this.value,130,180,200),this.cxt.strokeStyle="black",this.cxt.font="bold 150px Arial",this.cxt.strokeText(this.value,130,180,200),this.texture2d=new Laya.Texture2D(256,256),this.texture2d.loadImageSource(this.cav),t.albedoTexture=this.texture2d}checkColl(){if(this.hadColl||S.Share.isGameOver)return;let e=this.myOwner.transform.position.clone(),t=S.Share._mosquitoNode.transform.position.clone();if(Math.abs(e.z-t.z)<.1&&t.x>e.x-2&&t.x<e.x+2){i.DoVibrate(),this.hadColl=!0;let e=S.Share._mosquitoNode.numChildren;0==this.calType?e+=this.num:1==this.calType?e-=this.num:2==this.calType?e*=this.num:3==this.calType&&(e/=this.num),S.Share.updateMosquitoNum(Math.floor(e))}}onUpdate(){this.checkColl(),S.Share.isGameOver&&!this.hadClear&&(this.hadClear=!0,this.cxt.clearRect(0,0,256,256))}onDestroy(){this.texture2d.destroy()}}class l extends Laya.Script{constructor(){super(),this.myOwner=null,this.coll=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner,this.coll=this.myOwner.getChildAt(0).getChildAt(0)}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.coll.transform.position.clone(),t=S.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,i.DoVibrate(),S.Share.updateMosquitoNum(S.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}var h,d,c,y;!function(e){e.ANI_IDLE="idle",e.ANI_RUN="run"}(h||(h={}));class u extends Laya.Script{constructor(){super(),this.myOwner=null,this._ani=null,this.currentAniName=""}onAwake(){this.myOwner=this.owner,this._ani=this.owner.getComponent(Laya.Animator),this.playAnimation(h.ANI_RUN)}onDisable(){}getCurAniName(){return this._ani.getControllerLayer().getCurrentPlayState().animatorState.name}playAnimation(e,t=1,i=.2){this.currentAniName=e,this._ani.speed=t,this._ani.crossFade(e,i)}onUpdate(){}}class m extends Laya.Script{constructor(){super(),this.myOwner=null,this.isDied=!1,this.roadEdge=3,this.speed=.2}onAwake(){this.myOwner||(this.myOwner=this.owner)}onDisable(){}moveX(e){if(S.Share.isGameOver)return;if(this.myOwner.transform.position.x+e>this.roadEdge)return void(this.myOwner.transform.position=new Laya.Vector3(this.roadEdge,this.myOwner.transform.position.clone().y,this.myOwner.transform.position.clone().z));if(this.myOwner.transform.position.x+e<-this.roadEdge)return void(this.myOwner.transform.position=new Laya.Vector3(-this.roadEdge,this.myOwner.transform.position.clone().y,this.myOwner.transform.position.clone().z));let t=new Laya.Vector3(e,0,0);this.myOwner.transform.translate(t,!1)}onUpdate(){if(S.Share.isGameOver)for(let e=0;e<this.myOwner.numChildren;e++){this.myOwner.getChildAt(e).active=!0}else for(let e=0;e<this.myOwner.numChildren;e++){this.myOwner.getChildAt(e).active=e<50}!S.Share.isGameOver&&S.Share.isStartGame&&(this.myOwner.transform.translate(new Laya.Vector3(0,0,this.speed),!1),S.Share._camera.transform.translate(new Laya.Vector3(0,0,this.speed),!1),this.myOwner.transform.position.z>=S.Share._floorFinish.transform.position.z&&S.Share.finishCB(!0))}}class w{static inidAd(e){if(!Laya.Browser.onWeiXin)return void(e&&e());this.initBanner(),this.createVideoAd(),this.initGridAD(),this.createInterstitialAd();let t=()=>{this.isFullGridAdLoaded&&(Laya.timer.clear(this,t),e&&e())};Laya.timer.loop(100,this,t)}static getSystemInfoSync(){if(Laya.Browser.onWeiXin)return this.sysInfo||(this.sysInfo=Laya.Browser.window.wx.getSystemInfoSync()),this.sysInfo}static initBanner(){if(Laya.Browser.onWeiXin){this.bannerIdArr=this.shuffleArr(this.bannerIdArr),console.log("bannerId 数组排列：",this.bannerIdArr),!L.canTrapAll&&this.bannerAds.length>1&&this.bannerAds.splice(0,this.bannerAds.length-1);for(let e=0;e<this.bannerIdArr.length;e++)this.bannerTimesArr.push(0),this.bannerShowCount.push(0),this.bannerErrorArr.push(!1);for(let e=0;e<this.bannerIdArr.length;e++){let t=this.createBannerAd(e);this.bannerAds.push(t)}}}static get isAllBannerError(){let e=!0;for(let t=0;t<this.bannerErrorArr.length;t++)if(!this.bannerErrorArr[t]){e=!1;break}return e}static showBannerAd(){if(Laya.Browser.onWeiXin)if(this.isAllBannerError)this.stopCountBannerTime();else{for(let e=0;e<this.bannerErrorArr.length&&this.bannerErrorArr[this.bannerIndex];e++)this.bannerIndex++,this.bannerIndex>=this.bannerIdArr.length&&(this.bannerIndex=0);this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].show(),this.stopCountBannerTime(),L.canTrapAll&&Laya.timer.loop(100,this,this.countBannerTime)}}static hideBannerAd(){Laya.Browser.onWeiXin&&(this.isAllBannerError?this.stopCountBannerTime():(this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].hide(),this.stopCountBannerTime()))}static countBannerTime(){this.bannerTimesArr[this.bannerIndex]+=.1,this.bannerTimesArr[this.bannerIndex]>=L.jsonConfig.refresh_banner_time&&(this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].hide(),this.bannerTimesArr[this.bannerIndex]=0,this.bannerShowCount[this.bannerIndex]++,this.bannerShowCount[this.bannerIndex]>=L.jsonConfig.updateBanner&&(this.bannerShowCount[this.bannerIndex]=0,this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].destroy(),this.bannerAds[this.bannerIndex]=null,this.bannerAds[this.bannerIndex]=this.createBannerAd(this.bannerIndex)),this.bannerIndex++,this.bannerIndex>=this.bannerIdArr.length&&(this.bannerIndex=0),this.showBannerAd())}static stopCountBannerTime(){Laya.timer.clear(this,this.countBannerTime)}static createBannerAd(e,t=!1){if(!Laya.Browser.onWeiXin)return;let i=this.getSystemInfoSync(),a=Laya.Browser.window.wx.createBannerAd({adUnitId:this.bannerIdArr[e],style:{top:.8*i.screenHeight,width:300,left:i.screenWidth/2-150},adIntervals:30});return a.onLoad(()=>{t&&a.show(),this.bannerErrorArr[e]=!1,console.log("Banner广告加载成功")}),a.onError(t=>{this.bannerErrorArr[e]=!0,console.error("Banner广告加载失败",JSON.stringify(t))}),a.onResize(e=>{let t=a.style.realHeight+.1;a.style.top=i.screenHeight-t}),a}static createVideoAd(){if(Laya.Browser.onWeiXin){var e,t=this;null!=(e=this.videoAd)&&(e.offLoad(onLoadVideo),e.offError(onErrorVideo),e.offClose(onCloseVideo)),(e=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:t.videoId[0]})).onLoad(onLoadVideo),e.onError(onErrorVideo),e.onClose(onCloseVideo),this.videoAd=e}function onLoadVideo(){console.log("video 加载成功"),t.isExistVideoAd=!0}function onErrorVideo(e){console.error("video 加载错误",e),t.isExistVideoAd=!1}function onCloseVideo(e){!!(e&&e.isEnded||void 0===e)&&(t.videoFinishCallback&&t.videoFinishCallback(),t.videoFinishCallback=null),t.videoCancelCallback&&t.videoCancelCallback(),t.videoCancelCallback=null}}static showVideoAd(e,t){if(!Laya.Browser.onWeiXin)return e&&e(),void(t&&t());if(!Laya.Browser.onWeiXin)return;let i=this;if(this.videoFinishCallback=e,this.videoCancelCallback=t,this.isExistVideoAd||this.createVideoAd(),Laya.Browser.onWeiXin){var a=this.videoAd;a.show().then(()=>{}).catch(e=>{a.load().then(()=>a.show()).catch(e=>{i.videoCancelCallback&&i.videoCancelCallback(),i.videoCancelCallback=null})})}}static destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}static initGridAD(){Laya.Browser.onWeiXin&&(this.createFullGrid(),this.createBottomGrid(),this.createSideGrid(),this.createSingleGrid())}static createFullGrid(){Laya.Browser.onWeiXin&&(this.fullGridAd&&(this.fullGridAd.destroy(),this.fullGridAd=null),this.fullGridAd=Laya.Browser.window.wx.createCustomAd({adUnitId:this.fullGridId[0],adIntervals:30,style:{left:0,top:this.getSystemInfoSync().screenHeight/2-this.getSystemInfoSync().screenWidth/2-50,width:this.getSystemInfoSync().screenWidth}}),this.fullGridAd.onError(e=>{this.isFullGridAdLoaded=!0,this.fullGridError=!0,console.log("全屏格子加载失败:",JSON.stringify(e))}),this.fullGridAd.onLoad(()=>{this.isFullGridAdLoaded=!0,this.fullGridError=!1}))}static visibleFullGridAd(e=!0){Laya.Browser.onWeiXin&&this.fullGridAd&&!this.fullGridError&&(e?this.fullGridAd.show():this.fullGridAd.hide())}static getIsFullGridAdError(){return this.fullGridError&&this.createFullGrid(),this.fullGridError}static createBottomGrid(){this.bottomGridAd&&(this.bottomGridAd.destroy(),this.bottomGridAd=null),this.bottomGridAd=Laya.Browser.window.wx.createCustomAd({adUnitId:this.bottomGridId[0],adIntervals:30,style:{left:0,top:this.getSystemInfoSync().screenHeight-110,width:this.getSystemInfoSync().screenWidth}}),this.bottomGridAd.onError(e=>{this.bottomGridError=!0,console.log("底部格子加载失败:",JSON.stringify(e))}),this.bottomGridAd.onLoad(()=>{this.bottomGridError=!1})}static visibleBottomGridAd(e=!0){Laya.Browser.onWeiXin&&(this.bottomGridError?this.createBottomGrid():this.bottomGridAd&&(e?this.bottomGridAd.show():this.bottomGridAd.hide()))}static createSideGrid(){for(let e=0;e<this.sideGridAd.length;e++)this.sideGridAd[e].destroy(),this.sideGridAd=[];for(let e=0;e<2;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.sideGridId[0],adIntervals:30,style:{left:0==e?0:this.getSystemInfoSync().screenWidth-65,top:this.getSystemInfoSync().screenHeight/2-220}});t.onError(e=>{console.log("屏幕侧格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.sideGridAd.push(t)})}}static visibleSideGridAd(e=!0){if(Laya.Browser.onWeiXin)if(this.sideGridAd.length<=0)this.createSideGrid();else for(let t=0;t<this.sideGridAd.length;t++)e?this.sideGridAd[t].show():this.sideGridAd[t].hide()}static createSingleGrid(){for(let e=0;e<this.singleGridAd.length;e++)this.singleGridAd[e].destroy(),this.singleGridAd=[];for(let e=0;e<2;e++){let t=Laya.Browser.window.wx.createCustomAd({adUnitId:this.singleGridId[0],adIntervals:30,style:{left:0==e?0:this.getSystemInfoSync().screenWidth-65,top:120}});t.onError(e=>{console.log("屏幕单格子加载失败:",JSON.stringify(e))}),t.onLoad(()=>{this.singleGridAd.push(t)})}}static visibleSingleGridAd(e=!0){if(Laya.Browser.onWeiXin)if(this.singleGridAd.length<=0)this.createSingleGrid();else for(let t=0;t<this.singleGridAd.length;t++)e?this.singleGridAd[t].show():this.singleGridAd[t].hide()}static createInterstitialAd(){Laya.Browser.onWeiXin&&(this.intersititialAd&&(this.intersititialAd.offError(),this.intersititialAd.offLoad(),this.intersititialAd.offClose(),this.intersititialAd.destroy(),this.intersititialAd=null),this.intersititialAd=Laya.Browser.window.wx.createInterstitialAd({adUnitId:this.interstitialId[0]}),this.intersititialAd.onError(e=>{this.intersititialError=!0,console.log("插屏广告加载失败:",JSON.stringify(e))}),this.intersititialAd.onLoad(()=>{this.intersititialError=!1}),this.intersititialAd.onClose(()=>{this.intersititialCB&&this.intersititialCB()}),this.intersititialAd.load())}static showInterstitialAd(e){if(!Laya.Browser.onWeiXin||!this.intersititialAd||this.intersititialError)return this.intersititialError&&this.createInterstitialAd(),void(e&&e());this.intersititialCB=e,this.intersititialAd.show().then(()=>{}).catch(e=>{this.intersititialCB&&this.intersititialCB()})}static shuffleArr(e){let t=e.length;for(;t;){let i=Math.floor(Math.random()*t--);[e[i],e[t]]=[e[t],e[i]]}return e}}w.bannerIdArr=[],w.videoId=[],w.fullGridId=[],w.bottomGridId=[],w.sideGridId=[],w.singleGridId=[],w.interstitialId=[],w.bannerAds=[],w.bannerIndex=0,w.bannerTimesArr=[],w.bannerShowCount=[],w.bannerErrorArr=[],w.isExistVideoAd=!1,w.fullGridAd=null,w.fullGridError=!1,w.isFullGridAdLoaded=!1,w.bottomGridAd=null,w.bottomGridError=!1,w.sideGridAd=[],w.singleGridAd=[],w.intersititialAd=null,w.intersititialCB=null,w.intersititialError=!1;class L{static randTouchProgress(){this.wuchuProgressValue=this.getRangeNumer(.3,.8)}static getRangeNumer(e,t){return Math.random()*(t-e)+e}static bannerShowHide(){w.hideBannerAd(),Laya.timer.once(600,this,()=>{w.showBannerAd(),Laya.timer.once(800,this,()=>{this.bannerShowHide()})})}static videoBannerShowHide(){L.visibleVideoBanner(!1,!1),Laya.timer.once(600,this,()=>{L.visibleVideoBanner(!0,!1),Laya.timer.once(800,this,()=>{this.videoBannerShowHide()})})}static init(e){this.randTouchProgress(),Laya.Browser.onWeiXin?Laya.loader.load("WXSDK/FDConfig.json",Laya.Handler.create(this,t=>{L.version=t.version,L.appid=t.appid,L.secret=t.secret,this.getConfig(e)}),null,Laya.Loader.JSON):e&&e()}static loadGame(e){this.showReMen(()=>{this.showBox1(e)})}static showHomeUI(e){e?Laya.Scene.open(d.HomeUI,!1):Laya.Scene.close(d.HomeUI)}static showHomeUIReMen(e){Laya.Scene.open(d.Remen,!1,{ccb:e})}static showReMen(e){this.showRemen?Laya.Scene.open(d.Remen,!1,{ccb:e}):e&&e()}static showStartReMen(e){this.startRemen?Laya.Scene.open(d.Remen,!1,{ccb:e}):e&&e()}static showEndReMen(e){this.endRemen?Laya.Scene.open(d.Remen,!1,{ccb:e,showAdPic:this.endRemen_switch}):e&&e()}static showBox1(e){this.firstBox?Laya.Scene.open(d.Box1,!1,{ccb:e,type:this.firstBox_switch?c.Box_VideoBanner:c.Box_Banner}):e&&e()}static showBox2(e){this.bannerBox?Laya.Scene.open(d.Box1,!1,{ccb:e,type:this.bannerBox_switch?c.Box_VideoBanner:c.Box_Banner}):e&&e()}static visibleVideoBanner(e,t=!0){e?Laya.Scene.open(d.VideoBanner,!1,{showFinger:t}):Laya.Scene.close(d.VideoBanner)}static showVirtualWxpage(e){this.showVitualWx&&Laya.Browser.onWeiXin?Laya.Browser.window.wx.showModal({title:"提示",content:"未观看完广告无法获取奖励，是否继续？",success:t=>{this.showVirtualCount<this.jsonConfig.vitualWx_count?(this.showVirtualCount++,w.showVideoAd(null,()=>{this.showVirtualWxpage(e)})):(this.showVirtualCount=0,e&&e())}}):e&&e()}static inHomePage(e){this.showHomeUI(!0),w.showInterstitialAd(),w.visibleSideGridAd(),w.showBannerAd(),e&&e()}static inShop(){this.showHomeUI(!1),w.hideBannerAd(),w.visibleSideGridAd(!1),w.visibleBottomGridAd(!1)}static startGame(e){this.showHomeUI(!1),w.hideBannerAd(),w.visibleSideGridAd(!1),w.visibleBottomGridAd(!1),w.showInterstitialAd(()=>{this.showStartReMen(()=>{this.showBox2(()=>{this.showVirtualWxpage(e)})})})}static inGame(){w.showBannerAd(),w.visibleSingleGridAd()}static showGameOver(e){this.visibleVideoBanner(!1),w.hideBannerAd(),w.visibleSingleGridAd(!1),this.showEndReMen(e)}static inFinish(e){w.showInterstitialAd(),w.visibleSideGridAd(),w.hideBannerAd(),this.endBanner?(this.endBanner_switch?this.videoBannerShowHide():this.bannerShowHide(),e&&(e.bottom=20)):(e&&(e.bottom=300),w.showBannerAd())}static closeFinish(e){Laya.timer.clearAll(this),w.visibleBottomGridAd(!1),w.visibleSideGridAd(!1),this.visibleVideoBanner(!1),w.hideBannerAd(),this.gameCount++,this.loadGame(()=>{e&&e()})}static get allowScene(){if(Laya.Browser.onWeiXin&&this.jsonConfig.sceneList){let e=Laya.Browser.window.wx.getLaunchOptionsSync().scene.toString();return-1!=this.jsonConfig.sceneList.split(",").indexOf(e)}return!0}static getConfig(e){window.wxsdk.init({version:L.version,appid:L.appid,secret:L.secret,share:{title:"你能过得了这一关吗？",image:"https://game-oss.smallshark.cn/game/20211119/1216327431258.jpg?imageslim"}}),window.wxsdk.onInit(()=>{console.log("wxsdk初始化成功:",window.wxsdk);let t=new f;for(let e in t)t[e]=window.wxsdk.conf[e];this.jsonConfig=window.wxsdk.conf,console.log("config:",this.jsonConfig),this.jsonConfig.channel_ditch&&!window.wxsdk.user.channel&&(this.jsonConfig.allowMistouch=!1,console.log("config1:",this.jsonConfig)),w.bannerIdArr=window.wxsdk.conf.bannerIds?window.wxsdk.conf.bannerIds.split(","):[],w.videoId=window.wxsdk.conf.videoIds?window.wxsdk.conf.videoIds.split(","):[],w.fullGridId=window.wxsdk.conf.fullGridIds?window.wxsdk.conf.fullGridIds.split(","):[],w.bottomGridId=window.wxsdk.conf.bottomGridIds?window.wxsdk.conf.bottomGridIds.split(","):[],w.sideGridId=window.wxsdk.conf.sideGridIds?window.wxsdk.conf.sideGridIds.split(","):[],w.singleGridId=window.wxsdk.conf.singleGridIds?window.wxsdk.conf.singleGridIds.split(","):[],w.interstitialId=window.wxsdk.conf.interstitialIds?window.wxsdk.conf.interstitialIds.split(","):[],w.inidAd(()=>{e&&e()})}),window.wxsdk.login()}static get isVersionValid(){return!!Laya.Browser.onWeiXin&&this.version.split(".")[2]<=this.jsonConfig.version.split(".")[2]}static get canTrapAll(){return!!Laya.Browser.onWeiXin&&(this.allowScene&&this.jsonConfig.allowMistouch&&this.version.split(".")[2]<=this.jsonConfig.version.split(".")[2])}static get showRemen(){return!!Laya.Browser.onWeiXin&&this.jsonConfig.showRemen}static get startRemen(){return!!Laya.Browser.onWeiXin&&this.jsonConfig.startRemen}static get showVitualWx(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.showVitualWx)}static get remenBanner(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.remenBanner)}static get endRemen(){return!!Laya.Browser.onWeiXin&&this.jsonConfig.endRemen}static get endRemen_switch(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.endRemen_switch)}static get firstBox(){if(!Laya.Browser.onWeiXin)return!1;let e=!1;return e=this.jsonConfig.firstBox_interval_level<=0?this.gameCount>=this.jsonConfig.firstBox_level:this.gameCount>=this.jsonConfig.firstBox_level&&0==Math.floor((this.gameCount-this.jsonConfig.firstBox_level)%(this.jsonConfig.firstBox_interval_level+1)),this.canTrapAll&&this.jsonConfig.firstBox&&e}static get firstBox_switch(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.firstBox_switch)}static get bannerBox(){if(!Laya.Browser.onWeiXin)return!1;let e=!1;return e=this.jsonConfig.bannerBox_interval_level<=0?this.gameCount>=this.jsonConfig.bannerBox_level:this.gameCount>=this.jsonConfig.bannerBox_level&&0==Math.floor((this.gameCount-this.jsonConfig.bannerBox_level)%(this.jsonConfig.bannerBox_interval_level+1)),this.canTrapAll&&this.jsonConfig.bannerBox&&e}static get bannerBox_switch(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.bannerBox_switch)}static get endBanner(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.endBanner)}static get endBanner_switch(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.endBanner_switch)}static get homeViedo(){return!!Laya.Browser.onWeiXin&&(this.canTrapAll&&this.jsonConfig.homeViedo)}}L.version="1.0.7",L.appid="",L.secret="",L.wuchuProgressValue=0,L.wuchuProgressStepAdd=.2,L.wuchuProgressFrameSub=.01,L.gameCount=1,L.showVirtualCount=0;class f{}!function(e){e.Remen="FDScene/Remen.scene",e.Box1="FDScene/Box1.scene",e.VideoBanner="FDScene/VideoBanner.scene",e.HomeUI="FDScene/HomeUI.scene"}(d||(d={})),function(e){e[e.Box_Banner=0]="Box_Banner",e[e.Box_VideoBanner=1]="Box_VideoBanner"}(c||(c={})),function(e){e.ANI_IDLE="idle",e.ANI_SLAP="SLAP",e.ANI_dry="dry"}(y||(y={}));class g extends Laya.Script{constructor(){super(),this.myOwner=null,this.mosquitoNode=null,this._ani=null,this.currentAniName=""}onAwake(){this.myOwner=this.owner,this._ani=this.owner.getComponent(Laya.Animator),this.mosquitoNode=a.findNodeByName(this.myOwner,"mosquitoNode"),L.isVersionValid||(this.myOwner.getChildAt(1).skinnedMeshRenderer.material.albedoColor=new Laya.Vector4(1,0,0,1),this.myOwner.getChildAt(2).skinnedMeshRenderer.material.albedoColor=new Laya.Vector4(1,0,0,1)),this.playAnimation(y.ANI_IDLE)}onDisable(){}getCurAniName(){return this._ani.getControllerLayer().getCurrentPlayState().animatorState.name}playAnimation(e,t=1,i=.2){this.currentAniName=e,this._ani.speed=t,this._ani.crossFade(e,i)}onUpdate(){}}class p{constructor(){this.effectArr=[]}static get instance(){return this._instance||(this._instance=new p),this._instance}initLoading(e){var t=[{url:"res/Sounds/bgm.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/correct.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/hit.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/hurt.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/wrong.mp3",type:Laya.Loader.SOUND}];Laya.loader.load(t,Laya.Handler.create(this,e)),Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1)}playMusic(e,t=0,i){Laya.SoundManager.playMusic("res/Sounds/"+e,t,new Laya.Handler(this,i))}stopMusic(){Laya.SoundManager.stopMusic()}playSoundEffect(e,t=1,i,a,s){return Laya.SoundManager.playSound("res/Sounds/"+e,t,new Laya.Handler(this,i),a,s)}stopSound(e){Laya.SoundManager.stopSound("res/Sounds/"+e)}}class S{constructor(){this.camStartPos=new Laya.Vector3(0,0,0),this.camStartRotation=null,this._cameraCrl=null,this.lightStartAngle=new Laya.Vector3,this._levelNode=null,this._player=null,this._playerCrl=null,this.startCamField=80,this._floorFinish=null,this._Bench=null,this._woman=null,this._womanCrl=null,this._mosquitoNode=null,this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this.isFinish=!1,Laya.Browser.onWeiXin||localStorage.clear(),S.Share=this,t.getPlayerData(),Laya.Browser.onWeiXin&&(Laya.Browser.window.wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),Laya.Browser.window.wx.onShareAppMessage(()=>({title:"蚊子大作战",imageUrl:""}))),Laya.Scene.open("MyScenes/LoadingUI.scene")}initScene(){Laya.Scene3D.load(i.UnityPath+"SampleScene.ls",Laya.Handler.create(this,this.onLoadScene))}onLoadScene(e){if(Laya.Scene.open("MyScenes/StartUI.scene"),this._scene=Laya.stage.addChild(e),Laya.stage.setChildIndex(this._scene,0),this._camera=this._scene.getChildByName("Main Camera"),this._light=this._scene.getChildByName("Directional Light"),this._light.shadowMode=Laya.ShadowMode.SoftLow,this._light.shadowDistance=15,this._light.shadowResolution=512,this._light.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,this.lightStartAngle=this._light.transform.rotationEuler.clone(),this.camStartPos=this._camera.transform.position.clone(),this.camStartRotation=this._camera.transform.rotation.clone(),this._camera.fieldOfView=this.startCamField,this._cameraCrl=this._camera.addComponent(s),this._levelNode=new Laya.Sprite3D,this._scene.addChild(this._levelNode),this._Bench=this._scene.getChildByName("Scene_1").getChildByName("Bench"),this._woman=this._Bench.getChildAt(0),this._womanCrl=this._woman.addComponent(g),!L.isVersionValid){let e=this._camera.transform.localRotationEuler.clone();e.x=0,this._camera.transform.localRotationEuler=e,this.camStartPos.z+=5,this.camStartPos.y-=4,this._camera.transform.position=this.camStartPos,this._scene.getChildByName("Scene_1").active=!1}this._mosquitoNode=this._levelNode.addChild(new Laya.Sprite3D),this._playerCrl=this._mosquitoNode.addComponent(m),this.createLevel(),this.createMosquito()}gameStart(){Laya.Scene.open("MyScenes/GameUI.scene")}startToWalk(){}createLevel(){let e=t.getPlayerData().grade;e=(e-1)%5,L.isVersionValid||0!=e||(e=4);let i=t.levelDataArr[e];for(let e=0;e<i.length;e++){let t=i[e];this.createProp(t)}}createMosquito(){let e=this._mosquitoNode.numChildren,t=Laya.loader.getRes(i.UnityPath+"mosquito_1.lh");t.active=!1;let a=Laya.Sprite3D.instantiate(t,this._mosquitoNode,!1,new Laya.Vector3(0,0,0));a.addComponent(u),a.transform.localPosition=new Laya.Vector3(0==e?0:2.6*Math.random()-1.3,0==e?2.5:2*Math.random()-1+2.5,-e/5)}createProp(e){let t=e.name,i=new Laya.Vector3(Number(e.position.x),Number(e.position.y),Number(e.position.z)),s=new Laya.Vector3(Number(e.rotation.x),Number(e.rotation.y),Number(e.rotation.z)),h=new Laya.Vector3(Number(e.scale.x),Number(e.scale.y),Number(e.scale.z)),d=e.value.v,c=null;if(-1!=t.search("Floor_1"))c=a.getSprite3DResByUrl("Floor_1.lh",this._levelNode),L.isVersionValid||(c.meshRenderer.material.albedoColor=new Laya.Vector4(1,0,0,1));else if(-1!=t.search("Floor_Finsh")){c=a.getSprite3DResByUrl("Floor_Finsh.lh",this._levelNode),this._floorFinish=c;let e=this._Bench.transform.position.clone(),t=this._floorFinish.parent.getChildAt(this._floorFinish.parent.numChildren-2).transform.position.clone();e.z=t.z+80,this._Bench.transform.position=e}else if(-1!=t.search("Runer_1"))(c=a.getSprite3DResByUrl("Runer_1.lh",this._levelNode)).addComponent(o);else if(-1!=t.search("Hammer_1"))(c=a.getSprite3DResByUrl("Hammer_1.lh",this._levelNode)).addComponent(n);else if(-1!=t.search("Slice_1")){let e=(c=a.getSprite3DResByUrl("Slice_1.lh",this._levelNode)).addComponent(r);e.value=d,e.init(1)}else if(-1!=t.search("Slice_2")){let e=(c=a.getSprite3DResByUrl("Slice_2.lh",this._levelNode)).addComponent(r);e.value=d,e.init(2)}else-1!=t.search("Time_1")&&(c=a.getSprite3DResByUrl("Time_1.lh",this._levelNode)).addComponent(l);c.transform.position=i,c.transform.rotationEuler=s,c.transform.setWorldLossyScale(h)}updateMosquitoNum(e){if(e<=0)return this.createFX(this._mosquitoNode.transform.position.clone()),this._mosquitoNode.destroyChildren(),void this.finishCB(!1);let t=this._mosquitoNode.numChildren,i=Math.abs(e-t);if(e>t){p.instance.playSoundEffect("correct.mp3");for(let e=0;e<i;e++)this.createMosquito()}else if(e<t){p.instance.playSoundEffect("wrong.mp3");for(let e=i-1;e>=0;e--)this._mosquitoNode.getChildAt(this._mosquitoNode.numChildren-1).destroy();this.createFX(this._mosquitoNode.transform.position.clone())}}finishCB(e){if(this.isGameOver=!0,this.isWin=e,this.isStartGame=!1,e||i.DoVibrate(!1),e){for(let e=0;e<this._mosquitoNode.numChildren;e++){let t=this._mosquitoNode.getChildAt(e),i=t.transform.position.clone();i.x=6*Math.random()-3,i.z=this._floorFinish.transform.position.z+2,a.TmoveTo(t,1e3,i,null)}let e=this._camera.transform.position.clone();e.y=3,e.z+=2,a.TmoveTo(this._camera,1e3,e,()=>{Laya.timer.once(1e3,this,()=>{this.dryWoman()})});let t=this._camera.transform.rotationEuler.clone();t.x=0,a.RotateTo(this._camera,1e3,t,null)}else Laya.timer.once(2e3,this,()=>{L.showGameOver(()=>{Laya.Scene.open("MyScenes/FinishUI.scene")})})}dryWoman(){let e=this._mosquitoNode.numChildren;for(let e=this._mosquitoNode.numChildren-1;e>=0;e--){let t=this._mosquitoNode.getChildAt(e),i=this._womanCrl.mosquitoNode,s=i.transform.localPosition.clone();s.x=2.3*Math.random()-1.15,s.y-=e/15,s.z=-1.8;let n=i.transform.position.clone();Laya.Vector3.add(n,s,s),a.TmoveTo(t,500,s,()=>{t.transform.localRotationEuler=new Laya.Vector3(-90,0,0);let e=t.transform.position.clone(),a=t.transform.rotationEuler.clone(),s=i.addChild(t);s.transform.setWorldLossyScale(new Laya.Vector3(1,1,1)),s.transform.position=e,s.transform.rotationEuler=a})}Laya.timer.once(1e3,this,()=>{let t=this._camera.transform.position.clone();t.x=20,t.y=30,a.TmoveTo(this._camera,500,t,()=>{Laya.timer.once(1e3,this,()=>{e>=20?(this._womanCrl.playAnimation(y.ANI_dry,.5),Laya.timer.once(300,this,()=>{p.instance.playSoundEffect("hurt.mp3")})):(this._womanCrl.playAnimation(y.ANI_SLAP),Laya.timer.once(1e3,this,()=>{p.instance.playSoundEffect("hit.mp3"),this.createFX(this._womanCrl.mosquitoNode.transform.position.clone(),!1),this._womanCrl.mosquitoNode.destroyChildren()})),Laya.timer.once(2e3,this,()=>{L.showGameOver(()=>{Laya.Scene.open("MyScenes/FinishUI.scene")})})})});let i=this._camera.transform.rotationEuler.clone();i.x-=30,i.y-=20,a.RotateTo(this._camera,500,i,null)})}createFX(e,t=!0){t&&(e.z+=2);let i=a.getSprite3DResByUrl("mosquitoFX.lh",this._levelNode);i.transform.position=e,Laya.timer.once(500,this,()=>{i.destroy()})}restartGame(){this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this._camera.fieldOfView=this.startCamField,this.isFinish=!1,this._camera.transform.position=this.camStartPos,this._camera.transform.rotation=this.camStartRotation,this._light.transform.localRotationEuler=this.lightStartAngle,Laya.Browser.createElement("canvas").getContext("2d").clearRect(0,0,256,256),this._levelNode.destroyChildren(),this._mosquitoNode=this._levelNode.addChild(new Laya.Sprite3D),this._playerCrl=this._mosquitoNode.addComponent(m),this._womanCrl.mosquitoNode.destroyChildren(),this._womanCrl.playAnimation(y.ANI_IDLE),this.createLevel(),this.createMosquito()}}class B extends Laya.Scene{constructor(){super(...arguments),this.progressValue=0,this.clickCount=1,this.hadShowBanner=!1,this.onShowCB=null,this.type=c.Box_Banner}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(e){e&&e.ccb&&(this.ccb=e.ccb),e&&e.type&&(this.type=e.type),w.hideBannerAd(),this.btnPress.on(Laya.Event.CLICK,this,this.onPress),Laya.timer.frameLoop(1,this,this.reFreshUI),this.onShowCB=(()=>{this.close()}),Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(this.onShowCB)}onClosed(){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(this.onShowCB),w.hideBannerAd(),Laya.timer.clearAll(this),L.visibleVideoBanner(!1,!1),Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()})}onPress(){this.progressValue+=L.wuchuProgressStepAdd,Laya.Tween.to(this.btnPress,{scaleX:1.2,scaleY:1.2},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.btnPress,{scaleX:1,scaleY:1},100,null)})),this.progressValue>=L.wuchuProgressValue&&!this.hadShowBanner&&(this.hadShowBanner=!0,this.clickCount++,this.type==c.Box_Banner?w.showBannerAd():L.visibleVideoBanner(!0,!1),L.randTouchProgress(),Laya.timer.once(1e3,this,()=>{this.clickCount>=L.jsonConfig.bannerBox_count?this.close():(this.type==c.Box_Banner?w.hideBannerAd():L.visibleVideoBanner(!1,!1),this.hadShowBanner=!1,this.pressBar.value=0,this.progressValue=0)})),Laya.Tween.to(this.imgSushi,{rotation:30},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.imgSushi,{rotation:0},100)})),this.pressBar.value=this.progressValue}reFreshUI(){this.progressValue>L.wuchuProgressFrameSub&&(this.progressValue-=L.wuchuProgressFrameSub),this.pressBar.value=this.progressValue,this.light.rotation+=1}}class C extends Laya.Scene{constructor(){super()}onOpened(e){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.remenBtn.on(Laya.Event.CLICK,this,this.remenCB),this.videoBtn.on(Laya.Event.CLICK,this,this.videoCB),this.videoBtn.active=L.homeViedo}onClosed(){}remenCB(){w.hideBannerAd(),w.visibleSideGridAd(!1),L.showHomeUIReMen(()=>{w.showBannerAd(),w.visibleSideGridAd(!0)})}videoCB(){w.showVideoAd(()=>{Laya.Browser.window.wx.showToast({title:"恭喜获得1000金币！",duration:2e3,mask:!1,icon:"none"})},null)}}class A extends Laya.Scene{constructor(){super(),this.ccb=null,this.onShowCB=null,this.clickCount=0}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onOpened(e){e&&e.ccb&&(this.ccb=e.ccb),this.btnContinue.on(Laya.Event.CLICK,this,this.btnContinueCB),this.adPic.on(Laya.Event.CLICK,this,this.videoBtn),this.onShowCB=(()=>{this.close()}),Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(this.onShowCB),e&&e.showAdPic?this.adPic.visible=!0:(this.adPic.visible=!1,w.getIsFullGridAdError()?L.canTrapAll&&w.getIsFullGridAdError()&&(this.adPic.visible=!0):w.visibleFullGridAd()),this.adPic.visible=!1,L.remenBanner&&this.bannerShowHide(),w.bannerIndex=0}onClosed(){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(this.onShowCB),Laya.timer.clearAll(this),w.hideBannerAd(),w.visibleFullGridAd(!1),Laya.timer.once(100,this,()=>{this.ccb&&this.ccb()})}bannerShowHide(){w.hideBannerAd(),Laya.timer.once(600,this,()=>{w.showBannerAd(),Laya.timer.once(800,this,()=>{this.bannerShowHide()})})}videoBtn(){w.showVideoAd()}btnContinueCB(){this.clickCount++,this.clickCount>=L.jsonConfig.remenBanner_count&&this.close()}}class b extends Laya.Scene{constructor(){super()}onOpened(e){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.banner1.on(Laya.Event.CLICK,this,this.adBtnCB),this.banner2.on(Laya.Event.CLICK,this,this.adBtnCB);let t=!1;e&&e.showFinger&&(t=t),this.finger.visible=t,this.banner1.visible=Math.random()>.5,this.banner2.visible=!this.banner1.visible}onClosed(){}adBtnCB(){w.showVideoAd(()=>{Laya.Browser.window.wx.showToast({title:"恭喜获得1000金币！",duration:2e3,mask:!1,icon:"none"})},null)}}class x extends Laya.Scene{constructor(){super()}onOpened(e){let t=S.Share.isWin;this.winTitle.visible=t,this.loseTitle.visible=!t,this.nextBtn.visible=t,this.restartBtn.visible=!t,a.addClickEvent(this.restartBtn,this,this.back),a.addClickEvent(this.nextBtn,this,this.back),L.inFinish(t?this.nextBtn:this.restartBtn)}onClosed(){}back(){L.closeFinish(()=>{S.Share.isWin&&(t.getPlayerData().grade++,t.setPlayerData()),this.close(),S.Share.restartGame(),Laya.Scene.open("MyScenes/StartUI.scene",!0)})}}class v extends Laya.Script{constructor(){super()}onAwake(){let e=this.owner;e.y=e.y*Laya.stage.displayHeight/1334}}class _ extends Laya.Scene{constructor(){super(),this.touchStartX=0,this.touchPreX=0,this.touching=!1}onOpened(){_.Share=this,this.gradeNum.value=t.getPlayerData().grade.toString(),this.touchBtn.on(Laya.Event.MOUSE_DOWN,this,this.touchBtnDownCB),this.touchBtn.on(Laya.Event.MOUSE_MOVE,this,this.touchBtnMoveCB),this.touchBtn.on(Laya.Event.MOUSE_UP,this,this.touchBtnUpCB),this.touchBtn.on(Laya.Event.MOUSE_OUT,this,this.touchBtnUpCB),Laya.timer.frameLoop(1,this,this.updateCB),L.inGame()}onClosed(){Laya.timer.clearAll(this)}touchBtnDownCB(e){S.Share.isGameOver||(S.Share.isStartGame||(S.Share.isStartGame=!0,this.guideAni.visible=!1,this.countTips.visible=!0,S.Share.startToWalk()),this.touching=!0,this.touchStartX=e.stageX,this.touchPreX=e.stageX)}touchBtnMoveCB(e){if(!this.touching||S.Share.isGameOver||!S.Share.isStartGame)return;let t=e.stageX,i=this.touchPreX-t;S.Share._playerCrl.moveX(i/80),this.touchPreX=t}touchBtnUpCB(e){this.touching&&!S.Share.isGameOver&&S.Share.isStartGame&&(this.touching=!1)}updateCB(){this.countTips.visible=S.Share.isStartGame,this.gradeNum.value=t.getPlayerData().grade.toString(),this.countNum.value=S.Share._mosquitoNode.numChildren.toString();let e=S.Share._floorFinish.transform.position.z;this.disBar.value=S.Share._mosquitoNode.transform.position.z/e}}class I extends Laya.Scene{constructor(){super(),this.maxGrade=5}onOpened(){Laya.Browser.onWeiXin||localStorage.clear(),L.init(()=>{this.loadJsonData(1)}),Laya.timer.frameLoop(1,this,()=>{this.bar.value+=.01})}onClosed(){}loadJsonData(e){a.loadJson("res/config/Level"+e+".json",i=>{if(t.levelDataArr.push(i),++e>this.maxGrade)return this.loadRes(),void console.log("levelDataArr:",t.levelDataArr);this.loadJsonData(e)})}loadRes(){var e=[i.UnityPath+"Runer_1.lh",i.UnityPath+"Hammer_1.lh",i.UnityPath+"Slice_1.lh",i.UnityPath+"Slice_2.lh",i.UnityPath+"Floor_1.lh",i.UnityPath+"Floor_Finsh.lh",i.UnityPath+"Time_1.lh",i.UnityPath+"mosquito_1.lh",i.UnityPath+"mosquitoFX.lh"];Laya.loader.create(e,Laya.Handler.create(this,this.onComplete),Laya.Handler.create(this,this.onProgress))}onComplete(){L.loadGame(()=>{p.instance.initLoading(()=>{S.Share.initScene()})})}onProgress(e){}}class G extends Laya.Scene{constructor(){super(),this.hadStart=!1}onAwake(){p.instance.playMusic("bgm.mp3")}onOpened(){i.isStartUI=!0,Laya.timer.frameLoop(1,this,this.updateCB),this.startBtn.on(Laya.Event.CLICK,this,this.startBtnCB),L.inHomePage()}onClosed(){i.isStartUI=!1,Laya.timer.clearAll(this),w.hideBannerAd()}startBtnCB(){this.hadStart||(this.hadStart=!0,L.startGame(()=>{S.Share.gameStart()}))}updateCB(){}}class V extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.scaleLoop(this.myOwnwer,1.1,400)}scaleLoop(e,t,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},i,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},i,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,i)}))}))}}class N{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("FanDong/Box1.ts",B),e("FanDong/HomeUI.ts",C),e("FanDong/Remen.ts",A),e("FanDong/VideoBanner.ts",b),e("View/FinishUI.ts",x),e("Libs/FixNodeY.ts",v),e("View/GameUI.ts",_),e("View/LoadingUI.ts",I),e("View/StartUI.ts",G),e("Libs/ScaleLoop.ts",V)}}N.width=750,N.height=1334,N.scaleMode="fixedwidth",N.screenMode="vertical",N.alignV="top",N.alignH="left",N.startScene="FDScene/Box1.scene",N.sceneRoot="",N.debug=!1,N.stat=!1,N.physicsDebug=!1,N.exportSceneToJson=!0,N.init();new class{constructor(){window.Laya3D?Laya3D.init(N.width,N.height):Laya.init(N.width,N.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=N.scaleMode,Laya.stage.screenMode=N.screenMode,Laya.stage.alignV=N.alignV,Laya.stage.alignH=N.alignH,Laya.URL.exportSceneToJson=N.exportSceneToJson,Laya.stage.useRetinalCanvas=!0,(N.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),N.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),N.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){new S}}}();