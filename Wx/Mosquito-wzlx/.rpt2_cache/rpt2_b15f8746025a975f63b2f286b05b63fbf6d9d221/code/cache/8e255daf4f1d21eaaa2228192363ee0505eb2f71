{
  "code": "import Utility from \"../../Mod/Utility\";\r\nimport GameLogic from \"../GameLogic\";\r\nimport MoveComponent from \"../MoveComponent\";\r\nimport Player, { AniState } from \"../Player\";\r\nexport default class RoadFinish extends Laya.Script {\r\n    constructor() {\r\n        super();\r\n        this.isUsed = false;\r\n    }\r\n    onAwake() {\r\n        this.myOwner = this.owner;\r\n        this.myBB = Utility.getBoundBox(this.myOwner.getChildByName('FinishArea'));\r\n        this.stage1 = Utility.getBoundBox(this.myOwner.getChildByName('Stage1'));\r\n        this.stage2 = Utility.getBoundBox(this.myOwner.getChildByName('Stage2'));\r\n        this.stage3 = Utility.getBoundBox(this.myOwner.getChildByName('Stage3'));\r\n        this.stage4 = Utility.getBoundBox(this.myOwner.getChildByName('Stage4'));\r\n        this.finish = Utility.getBoundBox(this.myOwner.getChildByName('Finish'));\r\n        this.playerNode = this.myOwner.getChildByName('PlayerNode');\r\n        this.FXNode = this.myOwner.getChildByName('FXNode');\r\n        this.FXNode.active = false;\r\n        this.initPlayer();\r\n    }\r\n    onDisable() {\r\n    }\r\n    initPlayer() {\r\n        for (let i = 0; i < this.playerNode.numChildren; i++) {\r\n            let n = this.playerNode.getChildAt(i);\r\n            let name = Math.random() * 1 < 0.5 ? 'Man_01.lh' : 'Wuman_01.lh';\r\n            let player = Utility.getSprite3DResByUrl(name, n);\r\n            player.transform.localPosition = new Laya.Vector3(0, 0, 0);\r\n            player.transform.localRotationEuler = new Laya.Vector3(0, 0, 0);\r\n            let crl = player.addComponent(Player);\r\n            crl.playAnimation(AniState.ANI_SIT);\r\n            crl.isCrowed = true;\r\n            crl.changeSkin(Math.floor(Math.random() * 15), false);\r\n            crl.initShoes(Math.floor(Math.random() * 15), false);\r\n            crl.activeAcc(Math.floor(Math.random() * 15));\r\n        }\r\n    }\r\n    finishCB() {\r\n        this.FXNode.active = true;\r\n        for (let i = 0; i < this.playerNode.numChildren; i++) {\r\n            let n = this.playerNode.getChildAt(i);\r\n            let player = n.getChildAt(0);\r\n            let crl = player.getComponent(Player);\r\n            crl.playAnimation(AniState.ANI_UP);\r\n            Laya.timer.once(200, this, () => {\r\n                crl.playAnimation(AniState.ANI_WIN);\r\n            });\r\n        }\r\n    }\r\n    onUpdate() {\r\n        if (GameLogic.Share.isGameOver || !GameLogic.Share.isStartGame || GameLogic.Share.isPause)\r\n            return;\r\n        if (Laya.CollisionUtils.boxContainsBox(this.myBB, GameLogic.Share._playerCrl.getMyBB()) && !this.isUsed) {\r\n            this.isUsed = true;\r\n            GameLogic.Share._playerCrl.resetIdle(this.myOwner);\r\n            GameLogic.Share._playerCrl.fixPosY();\r\n            GameLogic.Share._player.getComponent(MoveComponent)._maxPosX = 1.5;\r\n        }\r\n        else if (Laya.CollisionUtils.boxContainsBox(this.stage1, GameLogic.Share._playerCrl.getMyBB()) && this.myOwner.getChildByName('Stage1')) {\r\n            GameLogic.Share._playerCrl.stopLerpPosY = true;\r\n            this.myOwner.getChildByName('Stage1').destroy();\r\n            GameLogic.Share._playerCrl.decShoes(null);\r\n        }\r\n        else if (Laya.CollisionUtils.boxContainsBox(this.stage2, GameLogic.Share._playerCrl.getMyBB()) && this.myOwner.getChildByName('Stage2')) {\r\n            this.myOwner.getChildByName('Stage2').destroy();\r\n            GameLogic.Share._playerCrl.decShoes(null);\r\n        }\r\n        else if (Laya.CollisionUtils.boxContainsBox(this.stage3, GameLogic.Share._playerCrl.getMyBB()) && this.myOwner.getChildByName('Stage3')) {\r\n            this.myOwner.getChildByName('Stage3').destroy();\r\n            GameLogic.Share._playerCrl.decShoes(null);\r\n        }\r\n        else if (Laya.CollisionUtils.boxContainsBox(this.stage4, GameLogic.Share._playerCrl.getMyBB()) && this.myOwner.getChildByName('Stage4')) {\r\n            this.myOwner.getChildByName('Stage4').destroy();\r\n            GameLogic.Share._playerCrl.decShoes(null);\r\n        }\r\n        else if (Laya.CollisionUtils.boxContainsBox(this.finish, GameLogic.Share._playerCrl.getMyBB()) && this.myOwner.getChildByName('Finish')) {\r\n            this.myOwner.getChildByName('Finish').destroy();\r\n            GameLogic.Share._playerCrl.decShoes(null);\r\n            GameLogic.Share.isFinish = true;\r\n        }\r\n        if (GameLogic.Share.isFinish && GameLogic.Share._player.transform.localPosition.z >= 25) {\r\n            this.finishCB();\r\n            GameLogic.Share.isFinish = false;\r\n            GameLogic.Share.isGameOver = true;\r\n            GameLogic.Share._playerCrl.goToDes();\r\n            GameLogic.Share._cameraCrl.startRotate();\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=RoadFinish.js.map",
  "references": [
    "E:/LayaProjects/HighHeels2.10.0/src/Mod/Utility.ts",
    "E:/LayaProjects/HighHeels2.10.0/src/Crl/GameLogic.ts",
    "E:/LayaProjects/HighHeels2.10.0/src/Crl/MoveComponent.ts",
    "E:/LayaProjects/HighHeels2.10.0/src/Crl/Player.ts"
  ],
  "map": "{\"version\":3,\"file\":\"RoadFinish.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/Crl/Prop/RoadFinish.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
