{
  "code": "import WxApi from \"../Libs/WxApi\";\r\nimport AdMgr from \"./AdMgr\";\r\nimport JJMgr from \"../JJExport/Common/JJMgr\";\r\nexport default class ShareMgr {\r\n    constructor() {\r\n        this.path = '';\r\n        this.picCount = 3;\r\n        this.preT = 0;\r\n        this.shareTips = [\r\n            '请分享到活跃的群！',\r\n            '请分享到不同群！',\r\n            '请分享给好友！',\r\n            '请分享给20人以上的群！'\r\n        ];\r\n    }\r\n    static get instance() {\r\n        if (!this._instance) {\r\n            this._instance = new ShareMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n    initShare() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            Laya.Browser.window.wx.showShareMenu({\r\n                withShareTicket: true,\r\n                menus: ['shareAppMessage', 'shareTimeline']\r\n            });\r\n            let dir = JJMgr.instance.dataConfig.front_share_config.image;\r\n            let content = JJMgr.instance.dataConfig.front_share_config.title;\r\n            Laya.Browser.window[\"wx\"].JJOnShareAppMessage(() => {\r\n                return {\r\n                    title: content,\r\n                    imageUrl: dir,\r\n                    query: null,\r\n                    id: JJMgr.instance.dataConfig.front_share_config.id\r\n                };\r\n            });\r\n        }\r\n    }\r\n    shareGame(cb) {\r\n        if (WxApi.front_share_number <= 0 && !AdMgr.instance.videoIsError) {\r\n            AdMgr.instance.showVideo(cb);\r\n            return;\r\n        }\r\n        WxApi.shareCallback = cb;\r\n        if (!Laya.Browser.onWeiXin) {\r\n            cb();\r\n            return;\r\n        }\r\n        WxApi.shareTime = new Date().getTime();\r\n        let dir = JJMgr.instance.dataConfig.front_share_config.image;\r\n        let content = JJMgr.instance.dataConfig.front_share_config.title;\r\n        Laya.Browser.window[\"wx\"].JJShareAppMessage(function () {\r\n            return {\r\n                title: content,\r\n                imageUrl: dir,\r\n                id: JJMgr.instance.dataConfig.front_share_config.id\r\n            };\r\n        }).then((res) => {\r\n            if (res) {\r\n                WxApi.shareCallback();\r\n                WxApi.front_share_number--;\r\n                Laya.Browser.window[\"wx\"].showToast({\r\n                    title: '分享成功',\r\n                    icon: 'none',\r\n                    duration: 2000\r\n                });\r\n                WxApi.shareCallback = null;\r\n            }\r\n            else {\r\n                WxApi.firstShare = false;\r\n                Laya.Browser.window[\"wx\"].showModal({\r\n                    title: '提示',\r\n                    content: this.shareTips[Math.floor(Math.random() * this.shareTips.length)],\r\n                    confirmText: '重新分享',\r\n                    success(res) {\r\n                        if (res.confirm) {\r\n                            console.log('用户点击确定');\r\n                            ShareMgr.instance.shareGame(WxApi.shareCallback);\r\n                        }\r\n                        else if (res.cancel) {\r\n                            console.log('用户点击取消');\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=ShareMgr.js.map",
  "references": [
    "E:/LayaProjects/HighHeels2.10.0/src/Libs/WxApi.ts",
    "E:/LayaProjects/HighHeels2.10.0/src/Mod/AdMgr.ts",
    "E:/LayaProjects/HighHeels2.10.0/src/JJExport/Common/JJMgr.ts"
  ],
  "map": "{\"version\":3,\"file\":\"ShareMgr.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/Mod/ShareMgr.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
