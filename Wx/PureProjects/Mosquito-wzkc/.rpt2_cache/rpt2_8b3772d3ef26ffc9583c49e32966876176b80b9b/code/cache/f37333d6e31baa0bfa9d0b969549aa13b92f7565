{
  "code": "import WxApi from \"../Libs/WxApi\";\r\nimport AdMgr from \"./AdMgr\";\r\nimport JJMgr from \"../JJExport/Common/JJMgr\";\r\nexport default class ShareMgr {\r\n    constructor() {\r\n        this.path = '';\r\n        this.picCount = 3;\r\n        this.preT = 0;\r\n        this.shareTips = [\r\n            '请分享到活跃的群！',\r\n            '请分享到不同群！',\r\n            '请分享给好友！',\r\n            '请分享给20人以上的群！'\r\n        ];\r\n    }\r\n    static get instance() {\r\n        if (!this._instance) {\r\n            this._instance = new ShareMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n    initShare() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            Laya.Browser.window.wx.showShareMenu({\r\n                withShareTicket: true,\r\n                menus: ['shareAppMessage', 'shareTimeline']\r\n            });\r\n            let dir = JJMgr.instance.dataConfig.front_share_config.image;\r\n            let content = JJMgr.instance.dataConfig.front_share_config.title;\r\n            Laya.Browser.window.wx.onShareAppMessage(function (res) {\r\n                return {\r\n                    title: content,\r\n                    imageUrl: dir,\r\n                };\r\n            });\r\n            Laya.Browser.window.wx.onShow((para) => {\r\n                if (WxApi.shareCallback) {\r\n                    console.log('share!!!');\r\n                    if (AdMgr.instance.adCloseCallback) {\r\n                        AdMgr.instance.adCloseCallback();\r\n                    }\r\n                    let t = new Date().getTime();\r\n                    let diff = t - WxApi.shareTime;\r\n                    if (diff / 1000 >= 3 && !WxApi.firstShare) {\r\n                        WxApi.shareCallback();\r\n                        Laya.Browser.window.wx.showToast({\r\n                            title: '分享成功',\r\n                            icon: 'none',\r\n                            duration: 2000\r\n                        });\r\n                        WxApi.front_share_number--;\r\n                        let fsn = parseInt(localStorage.getItem('front_share_number'));\r\n                        fsn--;\r\n                        localStorage.setItem('front_share_number', fsn.toString());\r\n                        WxApi.shareCallback = null;\r\n                    }\r\n                    else {\r\n                        WxApi.firstShare = false;\r\n                        Laya.Browser.window.wx.showModal({\r\n                            title: '提示',\r\n                            content: this.shareTips[Math.floor(Math.random() * this.shareTips.length)],\r\n                            confirmText: '重新分享',\r\n                            success(res) {\r\n                                if (res.confirm) {\r\n                                    console.log('用户点击确定');\r\n                                    ShareMgr.instance.shareGame(WxApi.shareCallback);\r\n                                }\r\n                                else if (res.cancel) {\r\n                                    console.log('用户点击取消');\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n    shareGame(cb) {\r\n        if (WxApi.front_share_number <= 0 && !AdMgr.instance.videoIsError) {\r\n            AdMgr.instance.showVideo(cb);\r\n            return;\r\n        }\r\n        WxApi.shareCallback = cb;\r\n        if (!Laya.Browser.onWeiXin) {\r\n            cb();\r\n            return;\r\n        }\r\n        WxApi.shareTime = new Date().getTime();\r\n        let dir = JJMgr.instance.dataConfig.front_share_config.image;\r\n        let content = JJMgr.instance.dataConfig.front_share_config.title;\r\n        Laya.Browser.window.wx.shareAppMessage({\r\n            title: content,\r\n            imageUrl: dir\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=ShareMgr.js.map",
  "references": [
    "E:/LayaProjects/PoleRush/src/Libs/WxApi.ts",
    "E:/LayaProjects/PoleRush/src/Mod/AdMgr.ts",
    "E:/LayaProjects/PoleRush/src/JJExport/Common/JJMgr.ts"
  ],
  "map": "{\"version\":3,\"file\":\"ShareMgr.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/Mod/ShareMgr.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
