{
  "code": "export default class AdvMgr {\r\n    constructor() {\r\n        this.videoAdId = '';\r\n        this.bannerAdId = '';\r\n        this.gridAdId = '';\r\n        this.videoAd = null;\r\n        this.bannerAd = null;\r\n        this.gridAd = null;\r\n        this.closeVideoCB = null;\r\n        this.isExistVideoAd = false;\r\n        this.isPlayAfterLoaded = false;\r\n        this.isBannerError = true;\r\n    }\r\n    static get instance() {\r\n        if (!this._instance) {\r\n            this._instance = new AdvMgr();\r\n        }\r\n        return this._instance;\r\n    }\r\n    get sysInfo() {\r\n        if (!this._sysInfo) {\r\n            this._sysInfo = wx[\"getSystemInfoSync\"]();\r\n        }\r\n        return this._sysInfo;\r\n    }\r\n    initAllAd() {\r\n        this.loadVideoAd();\r\n        this.initBanner();\r\n        this.initGrid();\r\n    }\r\n    loadVideoAd() {\r\n        if (Laya.Browser.onWeiXin) {\r\n            var self = this;\r\n            var videoAd = this.videoAd;\r\n            if (videoAd != null) {\r\n                videoAd.offLoad(onLoadVideo);\r\n                videoAd.offError(onErrorVideo);\r\n                videoAd.offClose(onCloseVideo);\r\n            }\r\n            var videoAd = Laya.Browser.window.wx.createRewardedVideoAd({ adUnitId: self.videoAdId });\r\n            videoAd.onLoad(onLoadVideo);\r\n            videoAd.onError(onErrorVideo);\r\n            videoAd.onClose(onCloseVideo);\r\n            this.videoAd = videoAd;\r\n        }\r\n        function onLoadVideo() {\r\n            console.log('video 加载成功');\r\n            self.isExistVideoAd = true;\r\n            if (self.isPlayAfterLoaded) {\r\n                self.isPlayAfterLoaded = false;\r\n                self.showVideoAd();\r\n            }\r\n        }\r\n        function onErrorVideo(err) {\r\n            console.error('video 加载错误', err);\r\n            self.isExistVideoAd = false;\r\n            if (self.closeVideoCB) {\r\n                self.closeVideoCB(false);\r\n                self.closeVideoCB = null;\r\n            }\r\n            Laya.SoundManager.muted = false;\r\n        }\r\n        function onCloseVideo(res) {\r\n            let isEnded = (res && res.isEnded || res === undefined) ? true : false;\r\n            if (self.closeVideoCB) {\r\n                self.closeVideoCB(isEnded);\r\n                self.closeVideoCB = null;\r\n            }\r\n            Laya.SoundManager.muted = false;\r\n            this.videoAd.load();\r\n        }\r\n    }\r\n    showVideoAd(closeVideoCB = null, isPlayAfterLoaded = false) {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        Laya.SoundManager.muted = true;\r\n        this.closeVideoCB = closeVideoCB;\r\n        if (!this.isExistVideoAd) {\r\n            this.isPlayAfterLoaded = isPlayAfterLoaded;\r\n            this.videoAd.load();\r\n            return;\r\n        }\r\n        if (Laya.Browser.onWeiXin) {\r\n            var videoAd = this.videoAd;\r\n            videoAd.show().then(() => { }).catch(err => {\r\n                videoAd.load().then(() => videoAd.show());\r\n            });\r\n        }\r\n    }\r\n    initBanner() {\r\n        this.isBannerError = true;\r\n        let isIphonex = false;\r\n        if (Laya.Browser.onWeiXin) {\r\n            Laya.Browser.window.wx.getSystemInfo({\r\n                success: res => {\r\n                    let modelmes = res.model;\r\n                    if (modelmes.search('iPhone X') != -1) {\r\n                        isIphonex = true;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        if (this.bannerAd) {\r\n            this.bannerAd.offResize();\r\n            this.bannerAd.offError();\r\n            this.bannerAd.offLoad();\r\n        }\r\n        this.bannerAd = Laya.Browser.window.wx.createBannerAd({\r\n            adUnitId: this.bannerAdId,\r\n            style: {\r\n                left: 0,\r\n                top: 0,\r\n                width: 300,\r\n                height: 300\r\n            }\r\n        });\r\n        this.bannerAd.onResize(res => {\r\n            if (isIphonex) {\r\n                this.bannerAd.style.top = this.sysInfo.windowHeight - this.bannerAd.style.realHeight - 10;\r\n            }\r\n            else {\r\n                this.bannerAd.style.top = this.sysInfo.windowHeight - this.bannerAd.style.realHeight;\r\n            }\r\n            this.bannerAd.style.left = this.sysInfo.windowWidth / 2 - this.bannerAd.style.realWidth / 2;\r\n        });\r\n        this.bannerAd.onLoad(() => {\r\n            this.isBannerError = false;\r\n        });\r\n        this.bannerAd.onError(res => {\r\n            this.isBannerError = true;\r\n            console.log('banner error:', JSON.stringify(res));\r\n        });\r\n    }\r\n    hideBanner() {\r\n        if (!Laya.Browser.onWeiXin || !this.bannerAd)\r\n            return;\r\n        this.bannerAd.hide();\r\n    }\r\n    showBanner() {\r\n        if (!Laya.Browser.onWeiXin || !this.bannerAd)\r\n            return;\r\n        this.bannerAd.show();\r\n    }\r\n    destroyBanner() {\r\n        if (!Laya.Browser.onWeiXin || !this.bannerAd)\r\n            return;\r\n        this.bannerAd.destroy();\r\n        this.bannerAd = null;\r\n    }\r\n    initGrid() {\r\n        if (!Laya.Browser.onWeiXin)\r\n            return;\r\n        this.gridAd = Laya.Browser.window.wx.createGridAd({\r\n            adUnitId: this.gridAdId,\r\n            adIntervals: 30,\r\n            adTheme: 'white',\r\n            gridCount: 5,\r\n            style: {\r\n                left: 0,\r\n                top: 300,\r\n                width: this.sysInfo.windowWidth,\r\n                height: 400\r\n            }\r\n        });\r\n        this.gridAd.onError((res) => {\r\n            console.log('格子广告加载失败:', JSON.stringify(res));\r\n        });\r\n    }\r\n    showGridAd() {\r\n        if (!Laya.Browser.onWeiXin || !this.gridAd)\r\n            return;\r\n        this.gridAd.show();\r\n    }\r\n    hideGridAd() {\r\n        if (!Laya.Browser.onWeiXin || !this.gridAd)\r\n            return;\r\n        this.gridAd.hide();\r\n    }\r\n    destroyGridAd() {\r\n        if (!Laya.Browser.onWeiXin || !this.gridAd)\r\n            return;\r\n        this.gridAd.destroy();\r\n        this.gridAd = null;\r\n    }\r\n}\r\n//# sourceMappingURL=AdvMgr.js.map",
  "references": [],
  "map": "{\"version\":3,\"file\":\"AdvMgr.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/MyScripts/AdvMgr.ts\"],\"names\":[],\"mappings\":\"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\"}"
}
