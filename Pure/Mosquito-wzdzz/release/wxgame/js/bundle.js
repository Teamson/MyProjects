!function(){"use strict";class e{constructor(){this.grade=1,this.coin=0,this.exitTime=0}}class t{static getPlayerData(){return localStorage.getItem("playerData")?null==this._playerData&&(this._playerData=JSON.parse(localStorage.getItem("playerData"))):(this._playerData=new e,localStorage.setItem("playerData",JSON.stringify(this._playerData))),this._playerData}static setPlayerData(){localStorage.setItem("playerData",JSON.stringify(this._playerData))}static changeCoin(e){this._playerData.coin+=e,this.setPlayerData()}static setExitTime(){this._playerData.exitTime=(new Date).getTime(),this.setPlayerData()}}t._playerData=null,t.powerMax=10,t.tempSkinId=-1,t.levelDataArr=[];class a{static LoginWx(e){if(!Laya.Browser.onWeiXin)return;let t=Laya.Browser.window.wx.getLaunchOptionsSync();Laya.Browser.window.wx.login({success(a){a.code&&(console.log("res.code:",a.code),e&&e(a.code,t.query))}})}static checkScope(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.getSetting({success:t=>{t.authSetting["scope.userInfo"]?console.log("已经授权"):(console.log("没有授权"),this.createScope(e))}})}static createScope(e){this.scopeBtn=Laya.Browser.window.wx.createUserInfoButton({type:"text",text:"",style:{left:e.x,top:e.y,width:e.width,height:e.height,lineHeight:40,backgroundColor:"#ffffff",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:0}}),this.scopeBtn.onTap(e=>{"getUserInfo:ok"==e.errMsg?(this.scopeBtn.destroy(),this.scopeBtn=null):"getUserInfo:fail auth deny"==e.errMsg&&(this.scopeBtn.destroy(),this.scopeBtn=null)})}static GetLaunchParam(e){Laya.Browser.onWeiXin&&(this.OnShowFun=e,e(this.GetLaunchPassVar()),Laya.Browser.window.wx.onShow(e=>{null!=this.OnShowFun&&this.OnShowFun(e),console.log("wx on show")}))}static GetLaunchPassVar(){return Laya.Browser.onWeiXin?Laya.Browser.window.wx.getLaunchOptionsSync():null}static WxOnHide(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onHide(e)}static WxOffHide(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offHide(e)}static WxOnShow(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.onShow(e)}static WxOffShow(e){e&&Laya.Browser.onWeiXin&&Laya.Browser.window.wx.offShow(e)}static httpRequest(e,t,a="get",i){var o=new Laya.HttpRequest;o.http.timeout=5e3,o.once(Laya.Event.COMPLETE,this,i),o.once(Laya.Event.ERROR,this,this.httpRequest,[e,t,a,i]),"get"==a?o.send(e+"?"+t,"",a,"text"):"post"==a&&o.send(e,JSON.stringify(t),a,"text")}static DoVibrate(e=!0){Laya.Browser.onWeiXin&&this.isVibrate&&(e?Laya.Browser.window.wx.vibrateShort():Laya.Browser.window.wx.vibrateLong())}static OpenAlert(e,t=2e3,a=!1){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.showToast({title:e,duration:t,mask:!1,icon:a?"success":"none"})}static NavigateApp(e,t,a,i,o){if(Laya.Browser.onWeiXin){Laya.Browser.window.wx.navigateToMiniProgram({appId:e,path:t,success(e){console.log("打开成功"),o()},fail(e){console.log("打开失败"),i()}})}}static preViewImage(e){Laya.Browser.onWeiXin&&Laya.Browser.window.wx.previewImage({current:e,urls:[e]})}}a.UnityPath="LayaScene_SampleScene/Conventional/",a.openId="",a.version="1.0.0",a.isVibrate=!0,a.isMusic=!0,a.OnShowFun=null,a.scopeBtn=null,a.shareCallback=null,a.front_share_number=0,a.sceneId=0,a.gotOfflineBounes=!1,a.configData=null,a.shareTime=0,a.firstShare=!0,a.hadShowFriendUI=!1,a.launchGameUI=!1,a.firstStartGame=!1,a.isKillBossUI=!1,a.fromKillBossUI=!1,a.killbossCallback=null,a.gameNavCallback=null,a.gameNavOnHide=!1,a.isStartUI=!1,a.isAuditor=!1,a.shieldAppid=!1,a.tempGrade=1;class i{static calcDistance(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static getWorldDis(e,t){let a=e.transform.position.clone(),i=t.transform.position.clone();return Laya.Vector3.distance(a,i)}static getDirectionAToB(e,t,a=!0){let i=e.transform.position.clone(),o=t.transform.position.clone(),s=new Laya.Vector3(0,0,0);return Laya.Vector3.subtract(o,i,s),a&&Laya.Vector3.normalize(s,s),s}static fixPosY(e,t=1334){return e*Laya.stage.displayHeight/t}static findNodeByName(e,t){let a=null,i=e=>{for(let o=0;o<e.numChildren;o++){if(e.getChildAt(o).name==t)return void(a=e.getChildAt(o));i(e.getChildAt(o))}};return i(e),a}static TmoveTo(e,t,a,i,o){if(!e.transform)return;let s=new Laya.Tween;var n=e.transform.position;s.to(e.transform.position,{x:a.x,y:a.y,z:a.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=n)})},t,o,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToYZ(e,t,a,i,o){if(!e.transform)return;let s=new Laya.Tween;var n=e.transform.position;return s.to(e.transform.position,{y:a.y,z:a.z,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=n)})},t,null,Laya.Handler.create(this,()=>{i&&i()})),s}static TmoveToX(e,t,a,i,o){if(!e.transform)return;let s=new Laya.Tween;var n=e.transform.localPosition;s.to(e.transform.localPosition,{x:a.x,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=n)})},t,null,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToY(e,t,a,i,o){if(!e.transform)return;let s=new Laya.Tween;var n=e.transform.localPosition;s.to(e.transform.localPosition,{y:a.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.localPosition=n)})},t,o,Laya.Handler.create(this,()=>{i&&i()}))}static TmoveToWorld(e,t,a,i,o){if(!e.transform)return;let s=new Laya.Tween;var n=e.transform.position;s.to(e.transform.position,{y:a.y,update:new Laya.Handler(this,()=>{e.transform&&(e.transform.position=n)})},t,null,Laya.Handler.create(this,()=>{i&&i()}))}static RotateWithPoint(e,t,a){let i=new Laya.Vector3,o=e.transform.localPosition.clone();return a=a*Math.PI/180,i.x=o.x*Math.cos(a)+(t.y*o.z-t.z*o.y)*Math.sin(a)+t.x*(t.x*o.x+t.y*o.y+t.z*o.z)*(1-Math.cos(a)),i.y=o.y*Math.cos(a)+(t.x*o.z-t.z*o.x)*Math.sin(a)+t.y*(t.x*o.x+t.y*o.y+t.z*o.z)*(1-Math.cos(a)),i.z=o.z*Math.cos(a)+(t.x*o.y-t.y*o.x)*Math.sin(a)+t.z*(t.x*o.x+t.y*o.y+t.z*o.z)*(1-Math.cos(a)),i}static RotateTo(e,t,a,i){var o=e.transform.rotationEuler;Laya.Tween.to(e.transform.rotationEuler,{x:a.x,y:a.y,z:a.z,update:new Laya.Handler(this,function(){e&&(e.transform.rotationEuler=o)})},t,Laya.Ease.cubicOut,Laya.Handler.create(this,function(){i&&i()}))}static tMove2D(e,t,a,i,o){Laya.Tween.to(e,{x:t,y:a},i,null,new Laya.Handler(this,()=>{o&&o()}))}static scaleTo2D(e,t,a,i){Laya.Tween.to(e,{scaleX:t,scaleY:t},a,null,new Laya.Handler(this,()=>{i&&i()}))}static alphaTo2D(e,t,a,i){Laya.Tween.to(e,{alpha:t},a,null,new Laya.Handler(this,()=>{i&&i()}))}static updateNumber(e,t,a,i=!0,o,s){let n=e*t,r=Math.floor((n-e)/60);r=r<=0?1:r;let l=()=>{o?((e+=r)>=n&&(e=n,s&&s(),Laya.timer.clear(this,l)),i?a.text=e.toString():a.value=e.toString()):((n-=r)<=e&&(n=e,s&&s(),Laya.timer.clear(this,l)),i?a.text=n.toString():a.value=n.toString())};Laya.timer.frameLoop(1,this,l)}static loadJson(e,t){Laya.loader.load(e,Laya.Handler.create(this,t),null,Laya.Loader.JSON)}static objectShake(e,t=1,a=.7){var i=t,o=1,s=e.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(i>0){var t=new Laya.Vector3;Laya.Vector3.scale((n=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(n,r,0)),a,t),Laya.Vector3.add(s,t,t),e.transform.localPosition=t,i-=.02*o}else i=0,e.transform.localPosition=s,Laya.timer.clear(this,updateShake);var n,r})}static getRandomItemInArr(e){return e[Math.floor(Math.random()*e.length)]}static shuffleArr(e){let t=e.length;for(;t;){let a=Math.floor(Math.random()*t--);[e[a],e[t]]=[e[t],e[a]]}return e}static GetRandom(e,t,a=!0){let i=t-e,o=Math.random()*(i+1);return o+=e,a?Math.floor(o):o}static coinCollectAnim(e,t,a,i=10,o){let s=i;for(var n=0;n<i;n++){let i=Laya.Pool.getItemByClass("coin",Laya.Image);i.skin="startUI/zy_zs_1.png",i.x=e.x,i.y=e.y,a.addChild(i);let n=300+100*Math.random()-50;Laya.Tween.to(i,{x:i.x+250*Math.random()-125,y:i.y+250*Math.random()-125},n),Laya.timer.once(n+50,this,function(){Laya.Tween.to(i,{x:t.x,y:t.y},400,null,new Laya.Handler(this,function(){a.removeChild(i),Laya.Pool.recover("coin",i),0==--s&&o&&o()}))})}}static scaleLoop(e,t,a){Laya.Tween.to(e,{scaleX:t,scaleY:t},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},a,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,a)}))}))}static rotateLoop(e,t,a){Laya.Tween.to(e,{rotation:t},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:-t},2*a,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{rotation:0},a,null,new Laya.Handler(this,()=>{this.rotateLoop(e,t,a)}))}))}))}static visibleDelay(e,t){e.visible=!1,Laya.timer.once(t,this,()=>{e.visible=!0})}static pointInPolygon(e,t){for(var a=e.x,i=e.y,o=!1,s=0,n=t.length-1;s<t.length;n=s++){var r=t[s].x,l=t[s].y,h=t[n].x,c=t[n].y;l>i!=c>i&&a<(h-r)*(i-l)/(c-l)+r&&(o=!o)}return o}static getSprite3DResByUrl(e,t,i=!1){let o=Laya.loader.getRes(a.UnityPath+e);return Laya.Sprite3D.instantiate(o,t,i,new Laya.Vector3(0,0,0))}static getRandomItemInArrWithoutSelf(e,t,a=1){let i=[].concat(t);return i.splice(i.indexOf(e),1),(i=this.shuffleArr(i)).slice(0,a)}static getBoundBox(e,t=!1){let a=e.getComponent(Laya.PhysicsCollider).colliderShape,i=e.transform.position.clone();i.x+=a.localOffset.x,i.y+=a.localOffset.y,i.z+=a.localOffset.z;let o=e.parent,s=1;o&&o.transform&&t&&(s=o.transform.localScaleZ);let n=new Laya.Vector3(i.x-a.sizeX/2,i.y-a.sizeY/2,i.z-a.sizeZ/2),r=new Laya.Vector3(i.x+a.sizeX/2,i.y+a.sizeY/2,i.z+a.sizeZ*s/2/2);return new Laya.BoundBox(n,r)}static getBoundBoxWithMinMax(e,t){return new Laya.BoundBox(e,t)}static addClickEvent(e,t,a,i,o){if(e.offAllCaller(t),e instanceof Laya.Button&&!o){let o=e=>{a&&a.call(t,e)};e.on(Laya.Event.CLICK,t,o,[i])}else{let o=60,s=1,n=e.scaleX*s,r=e.scaleY*s,l=.9*s,h=!1,c=t=>{h=!0,Laya.Tween.to(e,{scaleX:l,scaleY:l},o)};e.on(Laya.Event.MOUSE_DOWN,t,c,[i]);let d=i=>{0!=h&&(h=!1,Laya.Tween.to(e,{scaleX:n,scaleY:r},o,null,new Laya.Handler(t,()=>{a&&a.call(t,i)})))};e.on(Laya.Event.MOUSE_UP,t,d,[i]);let y=t=>{Laya.Tween.to(e,{scaleX:n,scaleY:r},o)};e.on(Laya.Event.MOUSE_OUT,t,y,[i])}}static getVector3(e,t,a){return new Laya.Vector3(Number(e),Number(t),Number(a))}}class o extends Laya.Script{constructor(){super()}onAwake(){this.myOwner=this.owner}onDisable(){}onUpdate(){}}class s extends Laya.Script{constructor(){super(),this.myOwner=null,this.coll=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner,this.coll=this.myOwner.getChildAt(0)}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.coll.transform.position.clone(),t=L.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,a.DoVibrate(),L.Share.updateMosquitoNum(L.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}class n extends Laya.Script{constructor(){super(),this.myOwner=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.myOwner.transform.position.clone(),t=L.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,a.DoVibrate(),L.Share.updateMosquitoNum(L.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}class r extends Laya.Script{constructor(){super(),this.myOwner=null,this.value="",this.type=1,this.plane=null,this.cxt=null,this.cav=null,this.calType=0,this.num=1,this.hadColl=!1,this.hadClear=!1,this.texture2d=null}onAwake(){this.myOwner=this.owner,this.plane=this.myOwner.getChildByName("Plane")}onDisable(){}init(e){if(this.type=e,"+"==this.value[0]){this.calType=0;let e=this.value.split("+");this.num=parseInt(e[1])}else if("-"==this.value[0]){this.calType=1;let e=this.value.split("-");this.num=parseInt(e[1])}else if("*"==this.value[0]){this.calType=2;let e=this.value.split("*");this.num=parseInt(e[1])}else if("/"==this.value[0]){this.calType=3;let e=this.value.split("/");this.num=parseInt(e[1])}if("*"==this.value[0]){let e=this.value.split("*");this.value="x"+e[1]}else if(-1!=this.value.search("/")){let e=this.value.split("/");this.value="÷"+e[1]}let t=this.plane.meshRenderer.material;this.cav=Laya.Browser.createElement("canvas"),this.cxt=this.cav.getContext("2d"),this.cav.width=256,this.cav.height=256,this.cxt.fillStyle="rgb(255,255,255)",this.cxt.font="bold 150px Arial",this.cxt.textAlign="center",this.cxt.textBaseline="center",this.cxt.fillText(this.value,130,180,200),this.cxt.strokeStyle="black",this.cxt.font="bold 150px Arial",this.cxt.strokeText(this.value,130,180,200),this.texture2d=new Laya.Texture2D(256,256),this.texture2d.loadImageSource(this.cav),t.albedoTexture=this.texture2d}checkColl(){if(this.hadColl||L.Share.isGameOver)return;let e=this.myOwner.transform.position.clone(),t=L.Share._mosquitoNode.transform.position.clone();if(Math.abs(e.z-t.z)<.1&&t.x>e.x-2&&t.x<e.x+2){a.DoVibrate(),this.hadColl=!0;let e=L.Share._mosquitoNode.numChildren;0==this.calType?e+=this.num:1==this.calType?e-=this.num:2==this.calType?e*=this.num:3==this.calType&&(e/=this.num),L.Share.updateMosquitoNum(Math.floor(e))}}onUpdate(){this.checkColl(),L.Share.isGameOver&&!this.hadClear&&(this.hadClear=!0,this.cxt.clearRect(0,0,256,256))}onDestroy(){this.texture2d.destroy()}}class l extends Laya.Script{constructor(){super(),this.myOwner=null,this.coll=null,this.hadColl=!1}onAwake(){this.myOwner=this.owner,this.coll=this.myOwner.getChildAt(0).getChildAt(0)}onDisable(){}checkColl(){if(this.hadColl)return;let e=this.coll.transform.position.clone(),t=L.Share._mosquitoNode.transform.position.clone();e.y=0,t.y=0,Laya.Vector3.distance(e,t)<2&&(this.hadColl=!0,a.DoVibrate(),L.Share.updateMosquitoNum(L.Share._mosquitoNode.numChildren-20))}onUpdate(){this.checkColl()}}var h,c;!function(e){e.ANI_IDLE="idle",e.ANI_RUN="run"}(h||(h={}));class d extends Laya.Script{constructor(){super(),this.myOwner=null,this._ani=null,this.currentAniName=""}onAwake(){this.myOwner=this.owner,this._ani=this.owner.getComponent(Laya.Animator),this.playAnimation(h.ANI_RUN)}onDisable(){}getCurAniName(){return this._ani.getControllerLayer().getCurrentPlayState().animatorState.name}playAnimation(e,t=1,a=.2){this.currentAniName=e,this._ani.speed=t,this._ani.crossFade(e,a)}onUpdate(){}}class y extends Laya.Script{constructor(){super(),this.myOwner=null,this.isDied=!1,this.roadEdge=3,this.speed=.2}onAwake(){this.myOwner||(this.myOwner=this.owner)}onDisable(){}moveX(e){if(L.Share.isGameOver)return;if(this.myOwner.transform.position.x+e>this.roadEdge)return void(this.myOwner.transform.position=new Laya.Vector3(this.roadEdge,this.myOwner.transform.position.clone().y,this.myOwner.transform.position.clone().z));if(this.myOwner.transform.position.x+e<-this.roadEdge)return void(this.myOwner.transform.position=new Laya.Vector3(-this.roadEdge,this.myOwner.transform.position.clone().y,this.myOwner.transform.position.clone().z));let t=new Laya.Vector3(e,0,0);this.myOwner.transform.translate(t,!1)}onUpdate(){if(L.Share.isGameOver)for(let e=0;e<this.myOwner.numChildren;e++){this.myOwner.getChildAt(e).active=!0}else for(let e=0;e<this.myOwner.numChildren;e++){this.myOwner.getChildAt(e).active=e<50}!L.Share.isGameOver&&L.Share.isStartGame&&(this.myOwner.transform.translate(new Laya.Vector3(0,0,this.speed),!1),L.Share._camera.transform.translate(new Laya.Vector3(0,0,this.speed),!1),this.myOwner.transform.position.z>=L.Share._floorFinish.transform.position.z&&L.Share.finishCB(!0))}}!function(e){e.ANI_IDLE="idle",e.ANI_SLAP="SLAP",e.ANI_dry="dry"}(c||(c={}));class u extends Laya.Script{constructor(){super(),this.myOwner=null,this.mosquitoNode=null,this._ani=null,this.currentAniName=""}onAwake(){this.myOwner=this.owner,this._ani=this.owner.getComponent(Laya.Animator),this.mosquitoNode=i.findNodeByName(this.myOwner,"mosquitoNode"),this.playAnimation(c.ANI_IDLE)}onDisable(){}getCurAniName(){return this._ani.getControllerLayer().getCurrentPlayState().animatorState.name}playAnimation(e,t=1,a=.2){this.currentAniName=e,this._ani.speed=t,this._ani.crossFade(e,a)}onUpdate(){}}class m{constructor(){this.effectArr=[]}static get instance(){return this._instance||(this._instance=new m),this._instance}initLoading(e){var t=[{url:"res/Sounds/bgm.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/correct.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/hit.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/hurt.mp3",type:Laya.Loader.SOUND},{url:"res/Sounds/wrong.mp3",type:Laya.Loader.SOUND}];Laya.loader.load(t,Laya.Handler.create(this,e)),Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1)}playMusic(e,t=0,a){Laya.SoundManager.playMusic("res/Sounds/"+e,t,new Laya.Handler(this,a))}stopMusic(){Laya.SoundManager.stopMusic()}playSoundEffect(e,t=1,a,i,o){return Laya.SoundManager.playSound("res/Sounds/"+e,t,new Laya.Handler(this,a),i,o)}stopSound(e){Laya.SoundManager.stopSound("res/Sounds/"+e)}}class w{static inidAd(){Laya.Browser.onWeiXin&&(this.initBanner(),this.createVideoAd())}static getSystemInfoSync(){if(Laya.Browser.onWeiXin)return this.sysInfo||(this.sysInfo=wx.getSystemInfoSync()),this.sysInfo}static initBanner(){if(Laya.Browser.onWeiXin)for(let e=0;e<this.bannerIdArr.length;e++){let t=this.createBannerAd(e);this.bannerAds.push(t)}}static showBannerAd(){Laya.Browser.onWeiXin&&this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].show()}static hideBannerAd(){Laya.Browser.onWeiXin&&this.bannerAds[this.bannerIndex]&&this.bannerAds[this.bannerIndex].hide()}static createBannerAd(e,t=!1){if(!Laya.Browser.onWeiXin)return;let a=this.getSystemInfoSync(),i=Laya.Browser.window.wx.createBannerAd({adUnitId:this.bannerIdArr[e],style:{top:.8*a.screenHeight,width:300,left:a.screenWidth/2-150},adIntervals:30});return i.onLoad(()=>{t&&i.show(),console.log("Banner广告加载成功")}),i.onError(e=>{console.error("Banner广告加载失败",JSON.stringify(e))}),i.onResize(e=>{let t=i.style.realHeight+.1;i.style.top=a.screenHeight-t}),i}static createVideoAd(){if(Laya.Browser.onWeiXin){var e,t=this;null!=(e=this.videoAd)&&(e.offLoad(onLoadVideo),e.offError(onErrorVideo),e.offClose(onCloseVideo)),(e=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:t.videoId})).onLoad(onLoadVideo),e.onError(onErrorVideo),e.onClose(onCloseVideo),this.videoAd=e}function onLoadVideo(){console.log("video 加载成功"),t.isExistVideoAd=!0}function onErrorVideo(e){console.error("video 加载错误",e),t.isExistVideoAd=!1}function onCloseVideo(e){!!(e&&e.isEnded||void 0===e)&&(t.videoFinishCallback&&t.videoFinishCallback(),t.videoFinishCallback=null),t.videoCancelCallback&&t.videoCancelCallback(),t.videoCancelCallback=null}}static showVideoAd(e,t){if(!Laya.Browser.onWeiXin)return e&&e(),void(t&&t());if(!Laya.Browser.onWeiXin)return;let a=this;if(this.videoFinishCallback=e,this.videoCancelCallback=t,this.isExistVideoAd||this.createVideoAd(),Laya.Browser.onWeiXin){var i=this.videoAd;i.show().then(()=>{}).catch(e=>{i.load().then(()=>i.show()).catch(e=>{a.videoCancelCallback&&a.videoCancelCallback(),a.videoCancelCallback=null})})}}static destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}static initGridAD(e,t=0,a=0){Laya.Browser.onWeiXin?(this.CreateGridAD(this.gridId,t,a),e&&(this.initGridCB=e)):e&&e(!1)}static CreateGridAD(e,t,a){try{if(Laya.Browser.window.wx.createCustomAd){var i=Laya.Browser.window.wx.createCustomAd({adUnitId:e,adIntervals:31,style:{left:t,top:a,width:Laya.Browser.clientWidth/2.2}});i.onLoad(e=>{w.gridAd=i,i.show(),w.initGridCB&&(w.initGridCB(!0),w.initGridCB=null)}),i.onError(e=>{console.error(e),w.initGridCB&&(w.initGridCB(!1),w.initGridCB=null)})}}catch(e){console.log("原生格子报错"+e),w.initGridCB&&(w.initGridCB(!1),w.initGridCB=null)}}static showGridAD(){return!!this.gridAd&&(this.gridAd.show(),!0)}static hideGridAD(){this.gridAd&&this.gridAd.hide(),Laya.timer.once(500,this,()=>{this.gridAd&&this.gridAd.hide()})}}w.bannerIdArr=["adunit-5537ccffe5089e5c"],w.videoId="adunit-52288ae43a30597b",w.gridId="adunit-21325c229f875aa3",w.bannerAds=[],w.bannerIndex=0,w.isExistVideoAd=!1;class L{constructor(){this.camStartPos=new Laya.Vector3(0,0,0),this.camStartRotation=null,this._cameraCrl=null,this.lightStartAngle=new Laya.Vector3,this._levelNode=null,this._player=null,this._playerCrl=null,this.startCamField=80,this._floorFinish=null,this._Bench=null,this._woman=null,this._womanCrl=null,this._mosquitoNode=null,this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this.isFinish=!1,Laya.Browser.onWeiXin||localStorage.clear(),L.Share=this,t.getPlayerData(),Laya.Browser.onWeiXin&&(Laya.Browser.window.wx.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),Laya.Browser.window.wx.onShareAppMessage(()=>({title:"蚊子快冲",imageUrl:""}))),w.inidAd(),Laya.Scene.open("MyScenes/LoadingUI.scene")}initScene(){Laya.Scene3D.load(a.UnityPath+"SampleScene.ls",Laya.Handler.create(this,this.onLoadScene))}onLoadScene(e){Laya.Scene.open("MyScenes/StartUI.scene"),this._scene=Laya.stage.addChild(e),Laya.stage.setChildIndex(this._scene,0),this._camera=this._scene.getChildByName("Main Camera"),this._light=this._scene.getChildByName("Directional Light"),this._light.shadowMode=Laya.ShadowMode.SoftLow,this._light.shadowDistance=15,this._light.shadowResolution=512,this._light.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,this.lightStartAngle=this._light.transform.rotationEuler.clone(),this.camStartPos=this._camera.transform.position.clone(),this.camStartRotation=this._camera.transform.rotation.clone(),this._camera.fieldOfView=this.startCamField,this._cameraCrl=this._camera.addComponent(o),this._levelNode=new Laya.Sprite3D,this._scene.addChild(this._levelNode),this._Bench=this._scene.getChildByName("Scene_1").getChildByName("Bench"),this._woman=this._Bench.getChildAt(0),this._womanCrl=this._woman.addComponent(u),this._mosquitoNode=this._levelNode.addChild(new Laya.Sprite3D),this._playerCrl=this._mosquitoNode.addComponent(y),this.createLevel(),this.createMosquito()}gameStart(){Laya.Scene.open("MyScenes/GameUI.scene")}startToWalk(){}createLevel(){let e=t.getPlayerData().grade;e=(e-1)%5;let a=t.levelDataArr[e];for(let e=0;e<a.length;e++){let t=a[e];this.createProp(t)}}createMosquito(){let e=this._mosquitoNode.numChildren,t=Laya.loader.getRes(a.UnityPath+"mosquito_1.lh");t.active=!1;let i=Laya.Sprite3D.instantiate(t,this._mosquitoNode,!1,new Laya.Vector3(0,0,0));i.addComponent(d),i.transform.localPosition=new Laya.Vector3(0==e?0:2.6*Math.random()-1.3,0==e?2.5:2*Math.random()-1+2.5,-e/5)}createProp(e){let t=e.name,a=new Laya.Vector3(Number(e.position.x),Number(e.position.y),Number(e.position.z)),o=new Laya.Vector3(Number(e.rotation.x),Number(e.rotation.y),Number(e.rotation.z)),h=new Laya.Vector3(Number(e.scale.x),Number(e.scale.y),Number(e.scale.z)),c=e.value.v,d=null;if(-1!=t.search("Floor_1"))d=i.getSprite3DResByUrl("Floor_1.lh",this._levelNode);else if(-1!=t.search("Floor_Finsh")){d=i.getSprite3DResByUrl("Floor_Finsh.lh",this._levelNode),this._floorFinish=d;let e=this._Bench.transform.position.clone(),t=this._floorFinish.parent.getChildAt(this._floorFinish.parent.numChildren-2).transform.position.clone();e.z=t.z+80,this._Bench.transform.position=e}else if(-1!=t.search("Runer_1"))(d=i.getSprite3DResByUrl("Runer_1.lh",this._levelNode)).addComponent(n);else if(-1!=t.search("Hammer_1"))(d=i.getSprite3DResByUrl("Hammer_1.lh",this._levelNode)).addComponent(s);else if(-1!=t.search("Slice_1")){let e=(d=i.getSprite3DResByUrl("Slice_1.lh",this._levelNode)).addComponent(r);e.value=c,e.init(1)}else if(-1!=t.search("Slice_2")){let e=(d=i.getSprite3DResByUrl("Slice_2.lh",this._levelNode)).addComponent(r);e.value=c,e.init(2)}else-1!=t.search("Time_1")&&(d=i.getSprite3DResByUrl("Time_1.lh",this._levelNode)).addComponent(l);d.transform.position=a,d.transform.rotationEuler=o,d.transform.setWorldLossyScale(h)}updateMosquitoNum(e){if(e<=0)return this.createFX(this._mosquitoNode.transform.position.clone()),this._mosquitoNode.destroyChildren(),void this.finishCB(!1);let t=this._mosquitoNode.numChildren,a=Math.abs(e-t);if(e>t){m.instance.playSoundEffect("correct.mp3");for(let e=0;e<a;e++)this.createMosquito()}else if(e<t){m.instance.playSoundEffect("wrong.mp3");for(let e=a-1;e>=0;e--)this._mosquitoNode.getChildAt(this._mosquitoNode.numChildren-1).destroy();this.createFX(this._mosquitoNode.transform.position.clone())}}finishCB(e){if(this.isGameOver=!0,this.isWin=e,this.isStartGame=!1,e||a.DoVibrate(!1),e){for(let e=0;e<this._mosquitoNode.numChildren;e++){let t=this._mosquitoNode.getChildAt(e),a=t.transform.position.clone();a.x=6*Math.random()-3,a.z=this._floorFinish.transform.position.z+2,i.TmoveTo(t,1e3,a,null)}let e=this._camera.transform.position.clone();e.y=3,e.z+=2,i.TmoveTo(this._camera,1e3,e,()=>{Laya.timer.once(1e3,this,()=>{this.dryWoman()})});let t=this._camera.transform.rotationEuler.clone();t.x=0,i.RotateTo(this._camera,1e3,t,null)}else Laya.timer.once(2e3,this,()=>{Laya.Scene.open("MyScenes/FinishUI.scene")})}dryWoman(){let e=this._mosquitoNode.numChildren;for(let e=this._mosquitoNode.numChildren-1;e>=0;e--){let t=this._mosquitoNode.getChildAt(e),a=this._womanCrl.mosquitoNode,o=a.transform.localPosition.clone();o.x=2.3*Math.random()-1.15,o.y-=e/15,o.z=-1.8;let s=a.transform.position.clone();Laya.Vector3.add(s,o,o),i.TmoveTo(t,500,o,()=>{t.transform.localRotationEuler=new Laya.Vector3(-90,0,0);let e=t.transform.position.clone(),i=t.transform.rotationEuler.clone(),o=a.addChild(t);o.transform.setWorldLossyScale(new Laya.Vector3(1,1,1)),o.transform.position=e,o.transform.rotationEuler=i})}Laya.timer.once(1e3,this,()=>{let t=this._camera.transform.position.clone();t.x=20,t.y=30,i.TmoveTo(this._camera,500,t,()=>{Laya.timer.once(1e3,this,()=>{e>=20?(this._womanCrl.playAnimation(c.ANI_dry,.5),Laya.timer.once(300,this,()=>{m.instance.playSoundEffect("hurt.mp3")})):(this._womanCrl.playAnimation(c.ANI_SLAP),Laya.timer.once(1e3,this,()=>{m.instance.playSoundEffect("hit.mp3"),this.createFX(this._womanCrl.mosquitoNode.transform.position.clone(),!1),this._womanCrl.mosquitoNode.destroyChildren()})),Laya.timer.once(2e3,this,()=>{Laya.Scene.open("MyScenes/FinishUI.scene")})})});let a=this._camera.transform.rotationEuler.clone();a.x-=30,a.y-=20,i.RotateTo(this._camera,500,a,null)})}createFX(e,t=!0){t&&(e.z+=2);let a=i.getSprite3DResByUrl("mosquitoFX.lh",this._levelNode);a.transform.position=e,Laya.timer.once(500,this,()=>{a.destroy()})}restartGame(){this.isStartGame=!1,this.isGameOver=!1,this.isWin=!1,this.isPause=!1,this._camera.fieldOfView=this.startCamField,this.isFinish=!1,this._camera.transform.position=this.camStartPos,this._camera.transform.rotation=this.camStartRotation,this._light.transform.localRotationEuler=this.lightStartAngle,Laya.Browser.createElement("canvas").getContext("2d").clearRect(0,0,256,256),this._levelNode.destroyChildren(),this._mosquitoNode=this._levelNode.addChild(new Laya.Sprite3D),this._playerCrl=this._mosquitoNode.addComponent(y),this._womanCrl.mosquitoNode.destroyChildren(),this._womanCrl.playAnimation(c.ANI_IDLE),this.createLevel(),this.createMosquito()}}class p extends Laya.Scene{constructor(){super()}onOpened(e){let t=L.Share.isWin;this.winTitle.visible=t,this.loseTitle.visible=!t,this.nextBtn.visible=t,this.restartBtn.visible=!t,i.addClickEvent(this.restartBtn,this,this.back),i.addClickEvent(this.nextBtn,this,this.back)}onClosed(){}back(){L.Share.isWin&&(t.getPlayerData().grade++,t.setPlayerData()),this.close(),L.Share.restartGame(),Laya.Scene.open("MyScenes/StartUI.scene",!0)}}class f extends Laya.Script{constructor(){super()}onAwake(){let e=this.owner;e.y=e.y*Laya.stage.displayHeight/1334}}class S extends Laya.Scene{constructor(){super(),this.touchStartX=0,this.touchPreX=0,this.touching=!1}onOpened(){S.Share=this,this.gradeNum.value=t.getPlayerData().grade.toString(),this.touchBtn.on(Laya.Event.MOUSE_DOWN,this,this.touchBtnDownCB),this.touchBtn.on(Laya.Event.MOUSE_MOVE,this,this.touchBtnMoveCB),this.touchBtn.on(Laya.Event.MOUSE_UP,this,this.touchBtnUpCB),this.touchBtn.on(Laya.Event.MOUSE_OUT,this,this.touchBtnUpCB),Laya.timer.frameLoop(1,this,this.updateCB),w.showBannerAd()}onClosed(){Laya.timer.clearAll(this),w.hideBannerAd()}touchBtnDownCB(e){L.Share.isGameOver||(L.Share.isStartGame||(L.Share.isStartGame=!0,this.guideAni.visible=!1,this.countTips.visible=!0,L.Share.startToWalk()),this.touching=!0,this.touchStartX=e.stageX,this.touchPreX=e.stageX)}touchBtnMoveCB(e){if(!this.touching||L.Share.isGameOver||!L.Share.isStartGame)return;let t=e.stageX,a=this.touchPreX-t;L.Share._playerCrl.moveX(a/80),this.touchPreX=t}touchBtnUpCB(e){this.touching&&!L.Share.isGameOver&&L.Share.isStartGame&&(this.touching=!1)}updateCB(){this.countTips.visible=L.Share.isStartGame,this.gradeNum.value=t.getPlayerData().grade.toString(),this.countNum.value=L.Share._mosquitoNode.numChildren.toString();let e=L.Share._floorFinish.transform.position.z;this.disBar.value=L.Share._mosquitoNode.transform.position.z/e}}class g extends Laya.Scene{constructor(){super(),this.maxGrade=5}onOpened(){Laya.Browser.onWeiXin||localStorage.clear(),this.loadJsonData(1),Laya.timer.frameLoop(1,this,()=>{this.bar.value+=.01})}onClosed(){}loadJsonData(e){i.loadJson("res/config/Level"+e+".json",a=>{if(t.levelDataArr.push(a),++e>this.maxGrade)return this.loadRes(),void console.log("levelDataArr:",t.levelDataArr);this.loadJsonData(e)})}loadRes(){var e=[a.UnityPath+"Runer_1.lh",a.UnityPath+"Hammer_1.lh",a.UnityPath+"Slice_1.lh",a.UnityPath+"Slice_2.lh",a.UnityPath+"Floor_1.lh",a.UnityPath+"Floor_Finsh.lh",a.UnityPath+"Time_1.lh",a.UnityPath+"mosquito_1.lh",a.UnityPath+"mosquitoFX.lh"];Laya.loader.create(e,Laya.Handler.create(this,this.onComplete),Laya.Handler.create(this,this.onProgress))}onComplete(){m.instance.initLoading(()=>{L.Share.initScene()})}onProgress(e){}}class C extends Laya.Scene{constructor(){super(),this.hadStart=!1}onAwake(){m.instance.playMusic("bgm.mp3")}onOpened(){a.isStartUI=!0,Laya.timer.frameLoop(1,this,this.updateCB),this.startBtn.on(Laya.Event.CLICK,this,this.startBtnCB),w.showBannerAd()}onClosed(){a.isStartUI=!1,Laya.timer.clearAll(this),w.hideBannerAd()}startBtnCB(){this.hadStart||(this.hadStart=!0,w.hideBannerAd(),L.Share.gameStart())}updateCB(){}}class v extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.scaleLoop(this.myOwnwer,1.1,400)}scaleLoop(e,t,a){Laya.Tween.to(e,{scaleX:t,scaleY:t},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(e,{scaleX:1,scaleY:1},a,null,new Laya.Handler(this,()=>{this.scaleLoop(e,t,a)}))}))}}class _{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("View/FinishUI.ts",p),e("Libs/FixNodeY.ts",f),e("View/GameUI.ts",S),e("View/LoadingUI.ts",g),e("View/StartUI.ts",C),e("Libs/ScaleLoop.ts",v)}}_.width=750,_.height=1334,_.scaleMode="fixedwidth",_.screenMode="vertical",_.alignV="top",_.alignH="left",_.startScene="MyScenes/FinishUI.scene",_.sceneRoot="",_.debug=!1,_.stat=!1,_.physicsDebug=!1,_.exportSceneToJson=!0,_.init();new class{constructor(){window.Laya3D?Laya3D.init(_.width,_.height):Laya.init(_.width,_.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=_.scaleMode,Laya.stage.screenMode=_.screenMode,Laya.stage.alignV=_.alignV,Laya.stage.alignH=_.alignH,Laya.URL.exportSceneToJson=_.exportSceneToJson,Laya.stage.useRetinalCanvas=!0,(_.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),_.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),_.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){new L}}}();